!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o=n(1);window.Powerbi=o["default"],window.powerbi=new o["default"]},function(e,t,n){"use strict";var o=n(2),r=n(4),i=n(5),s=n(3),a=function(){function e(t){void 0===t&&(t={}),this.embeds=[],window.addEventListener("message",this.onReceiveMessage.bind(this),!1),this.config=s["default"].assign({},e.defaultConfig,t),this.config.autoEmbedOnContentLoaded&&this.enableAutoEmbed()}return e.prototype.init=function(e){var t=this;e=e&&e instanceof HTMLElement?e:document.body;var n=Array.prototype.slice.call(e.querySelectorAll("["+o["default"].embedUrlAttribute+"]"));n.forEach(function(e){return t.embed(e)})},e.prototype.embed=function(e,t){void 0===t&&(t={});var n,o=e;return n=o.powerBiEmbed?this.embedExisting(o,t):this.embedNew(o,t)},e.prototype.embedNew=function(t,n){var i=this,a=n.type||t.getAttribute(o["default"].typeAttribute);if(!a)throw new Error("Attempted to embed using config "+JSON.stringify(n)+" on element "+t.outerHTML+", but could not determine what type of component to embed. You must specify a type in the configuration or as an attribute such as '"+o["default"].typeAttribute+'="'+r["default"].name.toLowerCase()+"\"'.");n.type=a;var u=s["default"].find(function(e){return a===e.name.toLowerCase()},e.components);if(!u)throw new Error("Attempted to embed component of type: "+a+" but did not find any matching component.  Please verify the type you specified is intended.");n.getGlobalAccessToken=function(){return i.accessToken};var c=new u(t,n);return t.powerBiEmbed=c,this.embeds.push(c),c},e.prototype.embedExisting=function(e,t){var n=s["default"].find(function(t){return t.element===e},this.embeds);if(!n)throw new Error("Attempted to embed using config "+JSON.stringify(t)+" on element "+e.outerHTML+" which already has embedded comopnent associated, but could not find the existing comopnent in the list of active components. This could indicate the embeds list is out of sync with the DOM, or the component is referencing the incorrect HTML element.");return n.load(t,!0),n},e.prototype.enableAutoEmbed=function(){var e=this;window.addEventListener("DOMContentLoaded",function(t){return e.init(document.body)},!1)},e.prototype.get=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");return t.powerBiEmbed},e.prototype.reset=function(e){var t=e;if(t.powerBiEmbed){s["default"].remove(function(e){return e===t.powerBiEmbed},this.embeds),delete t.powerBiEmbed;var n=e.querySelector("iframe");n&&n.remove()}},e.prototype.onReceiveMessage=function(t){if(t)try{var n=s["default"].find(function(e){return t.source===e.iframe.contentWindow},this.embeds);if(n){var o="string"==typeof t.data?JSON.parse(t.data):t.data;s["default"].raiseCustomEvent(n.element,e.eventMap[o.event],o)}}catch(r){if("function"!=typeof this.config.onError)throw r;this.config.onError.call(window,r)}},e.components=[i["default"],r["default"]],e.eventMap={tileClicked:"tile-click",tileLoaded:"tile-load",reportPageLoaded:"report-load"},e.defaultConfig={autoEmbedOnContentLoaded:!1,onError:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return console.log(e[0],e.slice(1))}},e}();t.PowerBi=a,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a},function(e,t,n){"use strict";var o=n(3),r=function(){function e(t,n){var r=this;this.element=t,this.options=o["default"].assign({},e.defaultOptions,n),this.options.accessToken=this.getAccessToken(),this.options.embedUrl=this.getEmbedUrl();var i='<iframe style="width:100%;height:100%;" src="'+this.options.embedUrl+'" scrolling="no" allowfullscreen="true"></iframe>';this.element.innerHTML=i,this.iframe=this.element.childNodes[0],this.iframe.addEventListener("load",function(){return r.load(r.options,!1)},!1)}return e.prototype.load=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=null),!n)throw new Error("You called load without providing message properties from the concrete embeddable class.");var r={accessToken:e.accessToken};o["default"].assign(n,r);var i={message:n};o["default"].raiseCustomEvent(this.element,i.message.action,i),this.iframe.contentWindow.postMessage(JSON.stringify(i.message),"*")},e.prototype.getAccessToken=function(){var t=this.options.accessToken||this.element.getAttribute(e.accessTokenAttribute)||this.options.getGlobalAccessToken();if(!t)throw new Error("No access token was found for element. You must specify an access token directly on the element using attribute '"+e.accessTokenAttribute+"' or specify a global token at: powerbi.accessToken.");return t},e.prototype.getEmbedUrl=function(){var t=this.options.embedUrl||this.element.getAttribute(e.embedUrlAttribute);if("string"!=typeof t||0===t.length)throw new Error("Embed Url is required, but it was not found. You must provide an embed url either as part of embed configuration or as attribute '"+e.embedUrlAttribute+"'.");return t},e.prototype.fullscreen=function(){var e=this.iframe.requestFullscreen||this.iframe.msRequestFullscreen||this.iframe.mozRequestFullScreen||this.iframe.webkitRequestFullscreen;e.call(this.iframe)},e.prototype.exitFullscreen=function(){if(this.isFullscreen(this.iframe)){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;e.call(document)}},e.prototype.isFullscreen=function(e){var t=["fullscreenElement","webkitFullscreenElement","mozFullscreenScreenElement","msFullscreenElement"];return t.some(function(t){return document[t]===e})},e.embedUrlAttribute="powerbi-embed-url",e.accessTokenAttribute="powerbi-access-token",e.typeAttribute="powerbi-type",e.defaultOptions={filterPaneEnabled:!0},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t){"use strict";var n=function(){function e(){}return e.raiseCustomEvent=function(e,t,n){var o;if("function"==typeof CustomEvent?o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(o),!o.defaultPrevented&&o.returnValue){var r="on"+t.replace("-",""),i=e.getAttribute(r);i&&eval.call(e,i)}},e.findIndex=function(e,t){if(!Array.isArray(t))throw new Error("You attempted to call find with second parameter that was not an array. You passed: "+t);var n;return t.some(function(t,o){return e(t)?(n=o,!0):void 0}),n},e.find=function(t,n){var o=e.findIndex(t,n);return n[o]},e.remove=function(t,n){var o=e.findIndex(t,n);n.splice(o,1)},e.assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e[0];if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}return o},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return this.options.filterPaneEnabled||(t+="&filterPaneEnabled=false"),t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadReport",reportId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t.name="Report",t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadTile",tileId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t.name="Tile",t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvd2VyYmkuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiY29yZV8xIiwid2luZG93IiwiUG93ZXJiaSIsInBvd2VyYmkiLCJlbWJlZF8xIiwicmVwb3J0XzEiLCJ0aWxlXzEiLCJ1dGlsXzEiLCJQb3dlckJpIiwiY29uZmlnIiwidGhpcyIsImVtYmVkcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiYmluZCIsImFzc2lnbiIsImRlZmF1bHRDb25maWciLCJhdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQiLCJlbmFibGVBdXRvRW1iZWQiLCJwcm90b3R5cGUiLCJpbml0IiwiY29udGFpbmVyIiwiX3RoaXMiLCJIVE1MRWxlbWVudCIsImRvY3VtZW50IiwiYm9keSIsImVsZW1lbnRzIiwiQXJyYXkiLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbWJlZFVybEF0dHJpYnV0ZSIsImZvckVhY2giLCJlbGVtZW50IiwiZW1iZWQiLCJjb21wb25lbnQiLCJwb3dlckJpRWxlbWVudCIsInBvd2VyQmlFbWJlZCIsImVtYmVkRXhpc3RpbmciLCJlbWJlZE5ldyIsImNvbXBvbmVudFR5cGUiLCJ0eXBlIiwiZ2V0QXR0cmlidXRlIiwidHlwZUF0dHJpYnV0ZSIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsIm91dGVySFRNTCIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsIkNvbXBvbmVudCIsImZpbmQiLCJjb21wb25lbnRzIiwiZ2V0R2xvYmFsQWNjZXNzVG9rZW4iLCJhY2Nlc3NUb2tlbiIsInB1c2giLCJ4IiwibG9hZCIsImV2ZW50IiwiZ2V0IiwicmVzZXQiLCJyZW1vdmUiLCJpZnJhbWUiLCJxdWVyeVNlbGVjdG9yIiwic291cmNlIiwiY29udGVudFdpbmRvdyIsIm1lc3NhZ2VEYXRhIiwiZGF0YSIsInBhcnNlIiwicmFpc2VDdXN0b21FdmVudCIsImV2ZW50TWFwIiwiZSIsIm9uRXJyb3IiLCJ0aWxlQ2xpY2tlZCIsInRpbGVMb2FkZWQiLCJyZXBvcnRQYWdlTG9hZGVkIiwiYXJncyIsIl9pIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJFbWJlZCIsIm9wdGlvbnMiLCJkZWZhdWx0T3B0aW9ucyIsImdldEFjY2Vzc1Rva2VuIiwiZW1iZWRVcmwiLCJnZXRFbWJlZFVybCIsImlmcmFtZUh0bWwiLCJpbm5lckhUTUwiLCJjaGlsZE5vZGVzIiwicmVxdWlyZUlkIiwibWVzc2FnZSIsImJhc2VNZXNzYWdlIiwiYWN0aW9uIiwicG9zdE1lc3NhZ2UiLCJhY2Nlc3NUb2tlbkF0dHJpYnV0ZSIsImZ1bGxzY3JlZW4iLCJyZXF1ZXN0RnVsbFNjcmVlbiIsInJlcXVlc3RGdWxsc2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsIm1velJlcXVlc3RGdWxsU2NyZWVuIiwid2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4iLCJleGl0RnVsbHNjcmVlbiIsImlzRnVsbHNjcmVlbiIsIm1vekNhbmNlbEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJzb21lIiwib3B0aW9uIiwiZmlsdGVyUGFuZUVuYWJsZWQiLCJVdGlscyIsImV2ZW50TmFtZSIsImV2ZW50RGF0YSIsImN1c3RvbUV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsImRlZmF1bHRQcmV2ZW50ZWQiLCJyZXR1cm5WYWx1ZSIsImlubGluZUV2ZW50QXR0ciIsInJlcGxhY2UiLCJpbmxpbmVTY3JpcHQiLCJldmFsIiwiZmluZEluZGV4IiwicHJlZGljYXRlIiwieHMiLCJpc0FycmF5IiwiaW5kZXgiLCJpIiwic3BsaWNlIiwidGFyZ2V0IiwidW5kZWZpbmVkIiwiVHlwZUVycm9yIiwib3V0cHV0IiwibmV4dEtleSIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiZCIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiUmVwb3J0IiwiX3N1cGVyIiwiYXBwbHkiLCJyZXBvcnRJZCIsIlRpbGUiLCJ0aWxlSWQiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdBS1QsUUFBU0MsR0FBb0JDLEdBRzVCLEdBQUdDLEVBQWlCRCxHQUNuQixNQUFPQyxHQUFpQkQsR0FBVUUsT0FHbkMsSUFBSUMsR0FBU0YsRUFBaUJELElBQzdCRSxXQUNBRSxHQUFJSixFQUNKSyxRQUFRLEVBVVQsT0FOQVAsR0FBUUUsR0FBVU0sS0FBS0gsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0gsR0FHL0RJLEVBQU9FLFFBQVMsRUFHVEYsRUFBT0QsUUF2QmYsR0FBSUQsS0FxQ0osT0FUQUYsR0FBb0JRLEVBQUlULEVBR3hCQyxFQUFvQlMsRUFBSVAsRUFHeEJGLEVBQW9CVSxFQUFJLEdBR2pCVixFQUFvQixLQUsvQixTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQixZQUNBLElBQUlXLEdBQVNYLEVBQW9CLEVBTWpDWSxRQUFPQyxRQUFVRixFQUFBQSxXQUNqQkMsT0FBT0UsUUFBVSxHQUFJSCxHQUFBQSxZQUtoQixTQUFTUCxFQUFRRCxFQUFTSCxHQUUvQixZQUNBLElBQUllLEdBQVVmLEVBQW9CLEdBQzlCZ0IsRUFBV2hCLEVBQW9CLEdBQy9CaUIsRUFBU2pCLEVBQW9CLEdBQzdCa0IsRUFBU2xCLEVBQW9CLEdBQzdCbUIsRUFBVyxXQUNYLFFBQVNBLEdBQVFDLEdBQ0UsU0FBWEEsSUFBcUJBLE1BQ3pCQyxLQUFLQyxVQUNMVixPQUFPVyxpQkFBaUIsVUFBV0YsS0FBS0csaUJBQWlCQyxLQUFLSixPQUFPLEdBRXJFQSxLQUFLRCxPQUFTRixFQUFBQSxXQUFlUSxV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QSxJQUFJMEosR0FBYXJJLE1BQVFBLEtBQUtxSSxXQUFjLFNBQVVDLEVBQUdDLEdBRXJELFFBQVNDLEtBQU94SSxLQUFLeUksWUFBY0gsRUFEbkMsSUFBSyxHQUFJakosS0FBS2tKLEdBQU9BLEVBQUVILGVBQWUvSSxLQUFJaUosRUFBRWpKLEdBQUtrSixFQUFFbEosR0FFbkRpSixHQUFFN0gsVUFBa0IsT0FBTjhILEVBQWFoRSxPQUFPbUUsT0FBT0gsSUFBTUMsRUFBRy9ILFVBQVk4SCxFQUFFOUgsVUFBVyxHQUFJK0gsS0FFL0U5SSxFQUFVZixFQUFvQixHQUM5Qm9LLEVBQVEsU0FBVUgsR0FFbEIsUUFBU0csS0FDTEgsRUFBT0MsTUFBTTdJLEtBQU1tRSxXQW1CdkIsTUFyQkFrRSxHQUFVVSxFQUFNSCxHQUloQkcsRUFBS3RJLFVBQVVzRSxZQUFjLFdBQ3pCLEdBQUlELEdBQVc4RCxFQUFPbkksVUFBVXNFLFlBQVk3RixLQUFLYyxLQUNqRCxPQUFPOEUsSUFFWGlFLEVBQUt0SSxVQUFVcUMsS0FBTyxTQUFVNkIsRUFBU1EsR0FFckMsR0FEa0IsU0FBZEEsSUFBd0JBLEdBQVksR0FDcENBLEdBQW1DLGdCQUFmUixHQUFRM0YsR0FDNUIsS0FBTSxJQUFJaUQsT0FBTSxrRUFFcEIsSUFBSW1ELElBQ0FFLE9BQVEsV0FDUjBELE9BQVFyRSxFQUFRM0YsR0FDaEIyRCxZQUFhLEtBRWpCaUcsR0FBT25JLFVBQVVxQyxLQUFLNUQsS0FBS2MsS0FBTTJFLEVBQVNRLEVBQVdDLElBRXpEMkQsRUFBSzFHLEtBQU8sT0FDTDBHLEdBQ1RySixFQUFBQSxXQUNGNkUsUUFBT0MsZUFBZTFGLEVBQVMsY0FBZ0IyRixPQUFPLElBQ3REM0YsRUFBQUEsV0FBa0JpSyIsImZpbGUiOiJwb3dlcmJpLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcclxuXHQvKipcclxuXHQgKiBNYWtlIFBvd2VyQmkgYXZhaWxhYmxlIG9uIGdsb2JhbCBvYmplY3QgZm9yIHVzZSBpbiBhcHBzIHdpdGhvdXQgbW9kdWxlIGxvYWRpbmcgc3VwcG9ydC5cclxuXHQgKiBTYXZlIGNsYXNzIHRvIGFsbG93IGNyZWF0aW5nIGFuIGluc3RhbmNlIG9mIHRoZSBzZXJ2aWNlLlxyXG5cdCAqIENyZWF0ZSBpbnN0YW5jZSBvZiBjbGFzcyB3aXRoIGRlZmF1bHQgY29uZmlnIGZvciBub3JtYWwgdXNhZ2UuXHJcblx0ICovXHJcblx0d2luZG93LlBvd2VyYmkgPSBjb3JlXzEuZGVmYXVsdDtcclxuXHR3aW5kb3cucG93ZXJiaSA9IG5ldyBjb3JlXzEuZGVmYXVsdCgpO1xyXG5cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgcmVwb3J0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xyXG5cdHZhciB0aWxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xyXG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xyXG5cdHZhciBQb3dlckJpID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gUG93ZXJCaShjb25maWcpIHtcclxuXHQgICAgICAgIGlmIChjb25maWcgPT09IHZvaWQgMCkgeyBjb25maWcgPSB7fTsgfVxyXG5cdCAgICAgICAgdGhpcy5lbWJlZHMgPSBbXTtcclxuXHQgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vblJlY2VpdmVNZXNzYWdlLmJpbmQodGhpcyksIGZhbHNlKTtcclxuXHQgICAgICAgIC8vIFRPRE86IENoYW5nZSB3aGVuIE9iamVjdC5hc3NpZ24gaXMgYXZhaWxhYmxlLlxyXG5cdCAgICAgICAgdGhpcy5jb25maWcgPSB1dGlsXzEuZGVmYXVsdC5hc3NpZ24oe30sIFBvd2VyQmkuZGVmYXVsdENvbmZpZywgY29uZmlnKTtcclxuXHQgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQpIHtcclxuXHQgICAgICAgICAgICB0aGlzLmVuYWJsZUF1dG9FbWJlZCgpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBIYW5kbGVyIGZvciBET01Db250ZW50TG9hZGVkIHdoaWNoIHNlYXJjaGVzIERPTSBmb3IgZWxlbWVudHMgaGF2aW5nICdwb3dlcmJpLWVtYmVkLXVybCcgYXR0cmlidXRlXHJcblx0ICAgICAqIGFuZCBhdXRvbWF0aWNhbGx5IGF0dGVtcHRzIHRvIGVtYmVkIGEgcG93ZXJiaSBjb21wb25lbnQgYmFzZWQgb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgYXR0cmlidXRlcy5cclxuXHQgICAgICogT25seSBydW5zIGlmIGBjb25maWcuYXV0b0VtYmVkT25Db250ZW50TG9hZGVkYCBpcyB0cnVlIHdoZW4gdGhlIHNlcnZpY2UgaXMgY3JlYXRlZC5cclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgY29udGFpbmVyID0gKGNvbnRhaW5lciAmJiBjb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgPyBjb250YWluZXIgOiBkb2N1bWVudC5ib2R5O1xyXG5cdCAgICAgICAgdmFyIGVsZW1lbnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIgKyBlbWJlZF8xLmRlZmF1bHQuZW1iZWRVcmxBdHRyaWJ1dGUgKyBcIl1cIikpO1xyXG5cdCAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gX3RoaXMuZW1iZWQoZWxlbWVudCk7IH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2l2ZW4gYW4gaHRtbCBlbGVtZW50IGVtYmVkIGNvbXBvbmVudCBiYXNlZCBvbiBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKiBJZiBjb21wb25lbnQgaGFzIGFscmVhZHkgYmVlbiBjcmVhdGVkIGFuZCBhdHRhY2hlZCB0byBlbGVtZW50IHJlLXVzZSBjb21wb25lbnQgaW5zdGFuY2UgYW5kIGV4aXN0aW5nIGlmcmFtZSxcclxuXHQgICAgICogb3RoZXJ3aXNlIGNyZWF0ZSBhIG5ldyBjb21wb25lbnQgaW5zdGFuY2VcclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVtYmVkID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgaWYgKGNvbmZpZyA9PT0gdm9pZCAwKSB7IGNvbmZpZyA9IHt9OyB9XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50O1xyXG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcclxuXHQgICAgICAgIGlmIChwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQpIHtcclxuXHQgICAgICAgICAgICBjb21wb25lbnQgPSB0aGlzLmVtYmVkRXhpc3RpbmcocG93ZXJCaUVsZW1lbnQsIGNvbmZpZyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICBjb21wb25lbnQgPSB0aGlzLmVtYmVkTmV3KHBvd2VyQmlFbGVtZW50LCBjb25maWcpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdpdmVuIGFuIGh0bWwgZWxlbWVudCBlbWJlZCBjb21wb25lbnQgYmFzZSBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKiBTYXZlIGNvbXBvbmVudCBpbnN0YW5jZSBvbiBlbGVtZW50IGZvciBsYXRlciBsb29rdXAuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbWJlZE5ldyA9IGZ1bmN0aW9uIChlbGVtZW50LCBjb25maWcpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50VHlwZSA9IGNvbmZpZy50eXBlIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGVtYmVkXzEuZGVmYXVsdC50eXBlQXR0cmlidXRlKTtcclxuXHQgICAgICAgIGlmICghY29tcG9uZW50VHlwZSkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBlbWJlZCB1c2luZyBjb25maWcgXCIgKyBKU09OLnN0cmluZ2lmeShjb25maWcpICsgXCIgb24gZWxlbWVudCBcIiArIGVsZW1lbnQub3V0ZXJIVE1MICsgXCIsIGJ1dCBjb3VsZCBub3QgZGV0ZXJtaW5lIHdoYXQgdHlwZSBvZiBjb21wb25lbnQgdG8gZW1iZWQuIFlvdSBtdXN0IHNwZWNpZnkgYSB0eXBlIGluIHRoZSBjb25maWd1cmF0aW9uIG9yIGFzIGFuIGF0dHJpYnV0ZSBzdWNoIGFzICdcIiArIGVtYmVkXzEuZGVmYXVsdC50eXBlQXR0cmlidXRlICsgXCI9XFxcIlwiICsgcmVwb3J0XzEuZGVmYXVsdC5uYW1lLnRvTG93ZXJDYXNlKCkgKyBcIlxcXCInLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIC8vIFNhdmUgdHlwZSBvbiBjb25maWd1cmF0aW9uIHNvIGl0IGNhbiBiZSByZWZlcmVuY2VkIGxhdGVyIGF0IGtub3duIGxvY2F0aW9uXHJcblx0ICAgICAgICBjb25maWcudHlwZSA9IGNvbXBvbmVudFR5cGU7XHJcblx0ICAgICAgICB2YXIgQ29tcG9uZW50ID0gdXRpbF8xLmRlZmF1bHQuZmluZChmdW5jdGlvbiAoY29tcG9uZW50KSB7IHJldHVybiBjb21wb25lbnRUeXBlID09PSBjb21wb25lbnQubmFtZS50b0xvd2VyQ2FzZSgpOyB9LCBQb3dlckJpLmNvbXBvbmVudHMpO1xyXG5cdCAgICAgICAgaWYgKCFDb21wb25lbnQpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZW1iZWQgY29tcG9uZW50IG9mIHR5cGU6IFwiICsgY29tcG9uZW50VHlwZSArIFwiIGJ1dCBkaWQgbm90IGZpbmQgYW55IG1hdGNoaW5nIGNvbXBvbmVudC4gIFBsZWFzZSB2ZXJpZnkgdGhlIHR5cGUgeW91IHNwZWNpZmllZCBpcyBpbnRlbmRlZC5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvLyBUT0RPOiBDb25zaWRlciByZW1vdmluZyBpbiBmYXZvciBvZiBwYXNzaW5nIHJlZmVyZW5jZSB0byBgdGhpc2AgaW4gY29uc3RydWN0b3JcclxuXHQgICAgICAgIC8vIFRoZSBnZXRHbG9iYWxBY2Nlc3NUb2tlbiBmdW5jdGlvbiBpcyBvbmx5IGhlcmUgc28gdGhhdCB0aGUgY29tcG9uZW50cyAoVGlsZSB8IFJlcG9ydCkgY2FuIGdldCB0aGUgZ2xvYmFsIGFjY2VzcyB0b2tlbiB3aXRob3V0IG5lZWRpbmcgcmVmZXJlbmNlXHJcblx0ICAgICAgICAvLyB0byB0aGUgc2VydmljZSB0aGF0IHRoZXkgYXJlIHJlZ2lzdGVyZWQgd2l0aGluIGJlY2F1ZXMgaXQgY3JlYXRlcyBjaXJjdWxhciBkZXBlbmRlbmNpZXNcclxuXHQgICAgICAgIGNvbmZpZy5nZXRHbG9iYWxBY2Nlc3NUb2tlbiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmFjY2Vzc1Rva2VuOyB9O1xyXG5cdCAgICAgICAgdmFyIGNvbXBvbmVudCA9IG5ldyBDb21wb25lbnQoZWxlbWVudCwgY29uZmlnKTtcclxuXHQgICAgICAgIGVsZW1lbnQucG93ZXJCaUVtYmVkID0gY29tcG9uZW50O1xyXG5cdCAgICAgICAgdGhpcy5lbWJlZHMucHVzaChjb21wb25lbnQpO1xyXG5cdCAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuXHQgICAgfTtcclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZW1iZWRFeGlzdGluZyA9IGZ1bmN0aW9uIChlbGVtZW50LCBjb25maWcpIHtcclxuXHQgICAgICAgIHZhciBjb21wb25lbnQgPSB1dGlsXzEuZGVmYXVsdC5maW5kKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmVsZW1lbnQgPT09IGVsZW1lbnQ7IH0sIHRoaXMuZW1iZWRzKTtcclxuXHQgICAgICAgIGlmICghY29tcG9uZW50KSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGVtYmVkIHVzaW5nIGNvbmZpZyBcIiArIEpTT04uc3RyaW5naWZ5KGNvbmZpZykgKyBcIiBvbiBlbGVtZW50IFwiICsgZWxlbWVudC5vdXRlckhUTUwgKyBcIiB3aGljaCBhbHJlYWR5IGhhcyBlbWJlZGRlZCBjb21vcG5lbnQgYXNzb2NpYXRlZCwgYnV0IGNvdWxkIG5vdCBmaW5kIHRoZSBleGlzdGluZyBjb21vcG5lbnQgaW4gdGhlIGxpc3Qgb2YgYWN0aXZlIGNvbXBvbmVudHMuIFRoaXMgY291bGQgaW5kaWNhdGUgdGhlIGVtYmVkcyBsaXN0IGlzIG91dCBvZiBzeW5jIHdpdGggdGhlIERPTSwgb3IgdGhlIGNvbXBvbmVudCBpcyByZWZlcmVuY2luZyB0aGUgaW5jb3JyZWN0IEhUTUwgZWxlbWVudC5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBjb21wb25lbnQubG9hZChjb25maWcsIHRydWUpO1xyXG5cdCAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciBmb3IgRE9NQ29udGVudExvYWRlZCB3aGljaCBmaW5kcyBhbGwgZWxlbWVudHMgaW4gRE9NIHdpdGggYXR0cmlidXRlIHBvd2VyYmktZW1iZWQtdXJsXHJcblx0ICAgICAqIHRoZW4gYXR0ZW1wdHMgdG8gaW5pdGlhdGUgdGhlIGVtYmVkIHByb2Nlc3MgYmFzZWQgb24gZGF0YSBmcm9tIG90aGVyIHBvd2VyYmktKiBhdHRyaWJ1dGVzLlxyXG5cdCAgICAgKiAoVGhpcyBpcyB1c3VhbGx5IG9ubHkgdXNlZnVsIGZvciBhcHBsaWNhdGlvbnMgcmVuZGVyZWQgb24gYnkgdGhlIHNlcnZlciBzaW5jZSBhbGwgdGhlIGRhdGEgbmVlZGVkIHdpbGwgYmUgYXZhaWxhYmxlIGJ5IHRoZSB0aW1lIHRoZSBoYW5kbGVyIGlzIGNhbGxlZC4pXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbmFibGVBdXRvRW1iZWQgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmluaXQoZG9jdW1lbnQuYm9keSk7IH0sIGZhbHNlKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJldHVybnMgaW5zdGFuY2Ugb2YgY29tcG9uZW50IGFzc29jaWF0ZWQgd2l0aCBlbGVtZW50LlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHQgICAgICAgIHZhciBwb3dlckJpRWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0ICAgICAgICBpZiAoIXBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBhdHRlbXB0ZWQgdG8gZ2V0IGFuIGluc3RhbmNlIG9mIHBvd2VyYmkgY29tcG9uZW50IGFzc29jaWF0ZWQgd2l0aCBlbGVtZW50OiBcIiArIGVsZW1lbnQub3V0ZXJIVE1MICsgXCIgYnV0IHRoZXJlIHdhcyBubyBhc3NvY2lhdGVkIGluc3RhbmNlLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQ7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBHaXZlbiBhbiBodG1sIGVsZW1lbnQgd2hpY2ggaGFzIGNvbXBvbmVudCBlbWJlZGRlZCB3aXRoaW4gaXQsIHJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gbGlzdCBvZiBlbWJlZHMsIHJlbW92ZSBhc3NvY2lhdGlvbiB3aXRoIGNvbXBvbmVudCwgYW5kIHJlbW92ZSB0aGUgaWZyYW1lLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcclxuXHQgICAgICAgIGlmICghcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLyoqIFJlbW92ZSBjb21wb25lbnQgZnJvbSBpbnRlcm5hbCBsaXN0ICovXHJcblx0ICAgICAgICB1dGlsXzEuZGVmYXVsdC5yZW1vdmUoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHggPT09IHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZDsgfSwgdGhpcy5lbWJlZHMpO1xyXG5cdCAgICAgICAgLyoqIERlbGV0ZSBwcm9wZXJ0eSBmcm9tIGh0bWwgZWxlbWVudCAqL1xyXG5cdCAgICAgICAgZGVsZXRlIHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZDtcclxuXHQgICAgICAgIC8qKiBSZW1vdmUgaWZyYW1lIGZyb20gZWxlbWVudCAqL1xyXG5cdCAgICAgICAgdmFyIGlmcmFtZSA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignaWZyYW1lJyk7XHJcblx0ICAgICAgICBpZiAoaWZyYW1lKSB7XHJcblx0ICAgICAgICAgICAgaWZyYW1lLnJlbW92ZSgpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogSGFuZGxlciBmb3Igd2luZG93IG1lc3NhZ2UgZXZlbnQuXHJcblx0ICAgICAqIFBhcnNlcyBldmVudCBkYXRhIGFzIGpzb24gYW5kIGlmIGl0IGNhbWUgZnJvbSBhbiBpZnJhbWUgdGhhdCBtYXRjaGVzIG9uZSBmcm9tIGFuIGV4aXN0aW5nIGVtYmVkZWQgY29tcG9uZW50IHJlLWRpc3BhdGNoZXMgdGhlIGV2ZW50IG9uIHRoZSBpZnJhbWUncyBwYXJlbnQgZWxlbWVudFxyXG5cdCAgICAgKiB0byBzaW11bGF0ZSB0aGUgZXZlbnQgYnViYmxpbmcgdGhyb3VnaCB0aGUgdHdvIHNlcGFyYXRlIHdpbmRvd3MgLyBET01zLlxyXG5cdCAgICAgKlxyXG5cdCAgICAgKiBJZiBhbiBlcnJvciBvY2N1cnMgd2hlbiBwYXJzaW5nIGV2ZW50LmRhdGEgY2FsbCBlcnJvciBoYW5kbGVyIHByb3ZpZGVkIGR1cmluZyBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUub25SZWNlaXZlTWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkge1xyXG5cdCAgICAgICAgaWYgKCFldmVudCkge1xyXG5cdCAgICAgICAgICAgIHJldHVybjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHRyeSB7XHJcblx0ICAgICAgICAgICAgLy8gT25seSByYWlzZSB0aGUgZXZlbnQgb24gdGhlIGVtYmVkIHRoYXQgbWF0Y2hlcyB0aGUgcG9zdCBtZXNzYWdlIG9yaWdpblxyXG5cdCAgICAgICAgICAgIHZhciBlbWJlZCA9IHV0aWxfMS5kZWZhdWx0LmZpbmQoZnVuY3Rpb24gKGVtYmVkKSB7IHJldHVybiBldmVudC5zb3VyY2UgPT09IGVtYmVkLmlmcmFtZS5jb250ZW50V2luZG93OyB9LCB0aGlzLmVtYmVkcyk7XHJcblx0ICAgICAgICAgICAgaWYgKGVtYmVkKSB7XHJcblx0ICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlRGF0YSA9IHR5cGVvZiBldmVudC5kYXRhID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkgOiBldmVudC5kYXRhO1xyXG5cdCAgICAgICAgICAgICAgICB1dGlsXzEuZGVmYXVsdC5yYWlzZUN1c3RvbUV2ZW50KGVtYmVkLmVsZW1lbnQsIFBvd2VyQmkuZXZlbnRNYXBbbWVzc2FnZURhdGEuZXZlbnRdLCBtZXNzYWdlRGF0YSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgY2F0Y2ggKGUpIHtcclxuXHQgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY29uZmlnLm9uRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICAgICAgdGhpcy5jb25maWcub25FcnJvci5jYWxsKHdpbmRvdywgZSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIExpc3Qgb2YgY29tcG9uZW50cyB0aGlzIHNlcnZpY2UgY2FuIGVtYmVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5jb21wb25lbnRzID0gW1xyXG5cdCAgICAgICAgdGlsZV8xLmRlZmF1bHQsXHJcblx0ICAgICAgICByZXBvcnRfMS5kZWZhdWx0XHJcblx0ICAgIF07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBNYXBwaW5nIG9mIGV2ZW50IG5hbWVzIGZyb20gaWZyYW1lIHBvc3RNZXNzYWdlIHRvIHRoZWlyIG5hbWUgcGVyY2lldmVkIGJ5IHBhcmVudCBET00uXHJcblx0ICAgICAqIEV4YW1wbGU6IFVzZXIgY2xpY2tzIG9uIGVtYmVkZWQgcmVwb3J0IHdoaWNoIGlzIGluc2lkZSBpZnJhbWUuIFRoZSBpZnJhbWUgY29kZSByZXNlbmRzXHJcblx0ICAgICAqIGV2ZW50IGFzIHBvc3RNZXNzYWdlIHdpdGggeyBldmVudDogJ3JlcG9ydENsaWNrZWQnLCAuLi4gfSBhbmQgdGhpcyBuYW1lIGlzIGNvbnZlcnRlZCB0byBoeXBoZW5hdGVkXHJcblx0ICAgICAqIG5hbWUgYW5kIGRpc3BhdGNoZWQgZnJvbSB0aGUgcGFyZW50IGVsZW1lbnQgb2YgdGhlIGlmcmFtZSB0byBzaW11bGF0ZSB0aGUgZXZlbnQgYnViYmxpbmcgdGhyb3VnaCB0d29cclxuXHQgICAgICogZGlmZmVyZW50IHdpbmRvd3MgLyBET01zXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLmV2ZW50TWFwID0ge1xyXG5cdCAgICAgICAgJ3RpbGVDbGlja2VkJzogJ3RpbGUtY2xpY2snLFxyXG5cdCAgICAgICAgJ3RpbGVMb2FkZWQnOiAndGlsZS1sb2FkJyxcclxuXHQgICAgICAgICdyZXBvcnRQYWdlTG9hZGVkJzogJ3JlcG9ydC1sb2FkJ1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogRGVmYXVsdCBjb25maWd1cmF0aW9uIGZvciBzZXJ2aWNlLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5kZWZhdWx0Q29uZmlnID0ge1xyXG5cdCAgICAgICAgYXV0b0VtYmVkT25Db250ZW50TG9hZGVkOiBmYWxzZSxcclxuXHQgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG5cdCAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcblx0ICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhhcmdzWzBdLCBhcmdzLnNsaWNlKDEpKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIFBvd2VyQmk7XHJcblx0fSgpKTtcclxuXHRleHBvcnRzLlBvd2VyQmkgPSBQb3dlckJpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBQb3dlckJpO1xyXG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xyXG5cdHZhciBFbWJlZCA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIEVtYmVkKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gT2JqZWN0LmFzc2lnbiBpcyBhdmFpbGFibGUuXHJcblx0ICAgICAgICB0aGlzLm9wdGlvbnMgPSB1dGlsXzEuZGVmYXVsdC5hc3NpZ24oe30sIEVtYmVkLmRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcclxuXHQgICAgICAgIHRoaXMub3B0aW9ucy5hY2Nlc3NUb2tlbiA9IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuXHQgICAgICAgIHRoaXMub3B0aW9ucy5lbWJlZFVybCA9IHRoaXMuZ2V0RW1iZWRVcmwoKTtcclxuXHQgICAgICAgIHZhciBpZnJhbWVIdG1sID0gXCI8aWZyYW1lIHN0eWxlPVxcXCJ3aWR0aDoxMDAlO2hlaWdodDoxMDAlO1xcXCIgc3JjPVxcXCJcIiArIHRoaXMub3B0aW9ucy5lbWJlZFVybCArIFwiXFxcIiBzY3JvbGxpbmc9XFxcIm5vXFxcIiBhbGxvd2Z1bGxzY3JlZW49XFxcInRydWVcXFwiPjwvaWZyYW1lPlwiO1xyXG5cdCAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGlmcmFtZUh0bWw7XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZSA9IHRoaXMuZWxlbWVudC5jaGlsZE5vZGVzWzBdO1xyXG5cdCAgICAgICAgdGhpcy5pZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmxvYWQoX3RoaXMub3B0aW9ucywgZmFsc2UpOyB9LCBmYWxzZSk7XHJcblx0ICAgIH1cclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIHdoZW4gdGhlIGlmcmFtZSBoYXMgZmluaXNoZWQgbG9hZGluZyB0aGUgcG93ZXJiaSBwbGFjZWhvbGRlciBwYWdlLlxyXG5cdCAgICAgKiBUaGlzIGlzIHVzZWQgdG8gaW5qZWN0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBzdWNoIGFzIGFjY2VzcyB0b2tlbiwgbG9hZEFjdGlvbiwgZXRjXHJcblx0ICAgICAqIHdoaWNoIGFsbG93IGlmcmFtZSB0byBsb2FkIHRoZSBhY3R1YWwgcmVwb3J0IHdpdGggYXV0aGVudGljYXRpb24uXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChvcHRpb25zLCByZXF1aXJlSWQsIG1lc3NhZ2UpIHtcclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgPT09IHZvaWQgMCkgeyByZXF1aXJlSWQgPSBmYWxzZTsgfVxyXG5cdCAgICAgICAgaWYgKG1lc3NhZ2UgPT09IHZvaWQgMCkgeyBtZXNzYWdlID0gbnVsbDsgfVxyXG5cdCAgICAgICAgaWYgKCFtZXNzYWdlKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGNhbGxlZCBsb2FkIHdpdGhvdXQgcHJvdmlkaW5nIG1lc3NhZ2UgcHJvcGVydGllcyBmcm9tIHRoZSBjb25jcmV0ZSBlbWJlZGRhYmxlIGNsYXNzLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBiYXNlTWVzc2FnZSA9IHtcclxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogb3B0aW9ucy5hY2Nlc3NUb2tlblxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LmFzc2lnbihtZXNzYWdlLCBiYXNlTWVzc2FnZSk7XHJcblx0ICAgICAgICB2YXIgZXZlbnQgPSB7XHJcblx0ICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LnJhaXNlQ3VzdG9tRXZlbnQodGhpcy5lbGVtZW50LCBldmVudC5tZXNzYWdlLmFjdGlvbiwgZXZlbnQpO1xyXG5cdCAgICAgICAgdGhpcy5pZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeShldmVudC5tZXNzYWdlKSwgJyonKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdldCBhY2Nlc3MgdG9rZW4gZnJvbSBmaXJzdCBhdmFpbGFibGUgbG9jYXRpb246IG9wdGlvbnMsIGF0dHJpYnV0ZSwgZ2xvYmFsLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmdldEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGFjY2Vzc1Rva2VuID0gdGhpcy5vcHRpb25zLmFjY2Vzc1Rva2VuIHx8IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoRW1iZWQuYWNjZXNzVG9rZW5BdHRyaWJ1dGUpIHx8IHRoaXMub3B0aW9ucy5nZXRHbG9iYWxBY2Nlc3NUb2tlbigpO1xyXG5cdCAgICAgICAgaWYgKCFhY2Nlc3NUb2tlbikge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGFjY2VzcyB0b2tlbiB3YXMgZm91bmQgZm9yIGVsZW1lbnQuIFlvdSBtdXN0IHNwZWNpZnkgYW4gYWNjZXNzIHRva2VuIGRpcmVjdGx5IG9uIHRoZSBlbGVtZW50IHVzaW5nIGF0dHJpYnV0ZSAnXCIgKyBFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSArIFwiJyBvciBzcGVjaWZ5IGEgZ2xvYmFsIHRva2VuIGF0OiBwb3dlcmJpLmFjY2Vzc1Rva2VuLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdldCBlbWJlZCB1cmwgZnJvbSBmaXJzdCBhdmFpbGFibGUgbG9jYXRpb246IG9wdGlvbnMsIGF0dHJpYnV0ZS5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IHRoaXMub3B0aW9ucy5lbWJlZFVybCB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKEVtYmVkLmVtYmVkVXJsQXR0cmlidXRlKTtcclxuXHQgICAgICAgIGlmICh0eXBlb2YgZW1iZWRVcmwgIT09ICdzdHJpbmcnIHx8IGVtYmVkVXJsLmxlbmd0aCA9PT0gMCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVtYmVkIFVybCBpcyByZXF1aXJlZCwgYnV0IGl0IHdhcyBub3QgZm91bmQuIFlvdSBtdXN0IHByb3ZpZGUgYW4gZW1iZWQgdXJsIGVpdGhlciBhcyBwYXJ0IG9mIGVtYmVkIGNvbmZpZ3VyYXRpb24gb3IgYXMgYXR0cmlidXRlICdcIiArIEVtYmVkLmVtYmVkVXJsQXR0cmlidXRlICsgXCInLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJlcXVlc3QgdGhlIGJyb3dzZXIgdG8gbWFrZSB0aGUgY29tcG9uZW50cyBpZnJhbWUgZnVsbHNjcmVlbi5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5mdWxsc2NyZWVuID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIHJlcXVlc3RGdWxsU2NyZWVuID0gdGhpcy5pZnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4gfHwgdGhpcy5pZnJhbWUubXNSZXF1ZXN0RnVsbHNjcmVlbiB8fCB0aGlzLmlmcmFtZS5tb3pSZXF1ZXN0RnVsbFNjcmVlbiB8fCB0aGlzLmlmcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbjtcclxuXHQgICAgICAgIHJlcXVlc3RGdWxsU2NyZWVuLmNhbGwodGhpcy5pZnJhbWUpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogRXhpdCBmdWxsc2NyZWVuLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmV4aXRGdWxsc2NyZWVuID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgaWYgKCF0aGlzLmlzRnVsbHNjcmVlbih0aGlzLmlmcmFtZSkpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgZXhpdEZ1bGxzY3JlZW4gPSBkb2N1bWVudC5leGl0RnVsbHNjcmVlbiB8fCBkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuIHx8IGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuIHx8IGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW47XHJcblx0ICAgICAgICBleGl0RnVsbHNjcmVlbi5jYWxsKGRvY3VtZW50KTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJldHVybiB0cnVlIGlmIGlmcmFtZSBpcyBmdWxsc2NyZWVuLFxyXG5cdCAgICAgKiBvdGhlcndpc2UgcmV0dXJuIGZhbHNlXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuaXNGdWxsc2NyZWVuID0gZnVuY3Rpb24gKGlmcmFtZSkge1xyXG5cdCAgICAgICAgdmFyIG9wdGlvbnMgPSBbJ2Z1bGxzY3JlZW5FbGVtZW50JywgJ3dlYmtpdEZ1bGxzY3JlZW5FbGVtZW50JywgJ21vekZ1bGxzY3JlZW5TY3JlZW5FbGVtZW50JywgJ21zRnVsbHNjcmVlbkVsZW1lbnQnXTtcclxuXHQgICAgICAgIHJldHVybiBvcHRpb25zLnNvbWUoZnVuY3Rpb24gKG9wdGlvbikgeyByZXR1cm4gZG9jdW1lbnRbb3B0aW9uXSA9PT0gaWZyYW1lOyB9KTtcclxuXHQgICAgfTtcclxuXHQgICAgRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUgPSAncG93ZXJiaS1lbWJlZC11cmwnO1xyXG5cdCAgICBFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSA9ICdwb3dlcmJpLWFjY2Vzcy10b2tlbic7XHJcblx0ICAgIEVtYmVkLnR5cGVBdHRyaWJ1dGUgPSAncG93ZXJiaS10eXBlJztcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIERlZmF1bHQgb3B0aW9ucyBmb3IgZW1iZWRkYWJsZSBjb21wb25lbnQuXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5kZWZhdWx0T3B0aW9ucyA9IHtcclxuXHQgICAgICAgIGZpbHRlclBhbmVFbmFibGVkOiB0cnVlXHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBFbWJlZDtcclxuXHR9KCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBFbWJlZDtcclxuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgVXRpbHMgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBVdGlscygpIHtcclxuXHQgICAgfVxyXG5cdCAgICBVdGlscy5yYWlzZUN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgZXZlbnREYXRhKSB7XHJcblx0ICAgICAgICB2YXIgY3VzdG9tRXZlbnQ7XHJcblx0ICAgICAgICBpZiAodHlwZW9mIEN1c3RvbUV2ZW50ID09PSAnZnVuY3Rpb24nKSB7XHJcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnROYW1lLCB7XHJcblx0ICAgICAgICAgICAgICAgIGRldGFpbDogZXZlbnREYXRhLFxyXG5cdCAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxyXG5cdCAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlXHJcblx0ICAgICAgICAgICAgfSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICBjdXN0b21FdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xyXG5cdCAgICAgICAgICAgIGN1c3RvbUV2ZW50LmluaXRDdXN0b21FdmVudChldmVudE5hbWUsIHRydWUsIHRydWUsIGV2ZW50RGF0YSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xyXG5cdCAgICAgICAgaWYgKGN1c3RvbUV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgfHwgIWN1c3RvbUV2ZW50LnJldHVyblZhbHVlKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLy8gVE9ETzogUmVtb3ZlIHRoaXM/IFNob3VsZCBiZSBiZXR0ZXIgd2F5IHRvIGhhbmRsZSBldmVudHMgdGhhbiB1c2luZyBldmFsP1xyXG5cdCAgICAgICAgLy8gV2hhdCBpcyB1c2UgY2FzZT8gPGRpdiBwb3dlcmJpLXR5cGU9XCJyZXBvcnRcIiBvbmxvYWQ9XCJhbGVydCgnbG9hZGVkJyk7XCI+PC9kaXY+XHJcblx0ICAgICAgICB2YXIgaW5saW5lRXZlbnRBdHRyID0gJ29uJyArIGV2ZW50TmFtZS5yZXBsYWNlKCctJywgJycpO1xyXG5cdCAgICAgICAgdmFyIGlubGluZVNjcmlwdCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGlubGluZUV2ZW50QXR0cik7XHJcblx0ICAgICAgICBpZiAoaW5saW5lU2NyaXB0KSB7XHJcblx0ICAgICAgICAgICAgZXZhbC5jYWxsKGVsZW1lbnQsIGlubGluZVNjcmlwdCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLmZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHhzKSB7XHJcblx0ICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoeHMpKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBjYWxsIGZpbmQgd2l0aCBzZWNvbmQgcGFyYW1ldGVyIHRoYXQgd2FzIG5vdCBhbiBhcnJheS4gWW91IHBhc3NlZDogXCIgKyB4cyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgaW5kZXg7XHJcblx0ICAgICAgICB4cy5zb21lKGZ1bmN0aW9uICh4LCBpKSB7XHJcblx0ICAgICAgICAgICAgaWYgKHByZWRpY2F0ZSh4KSkge1xyXG5cdCAgICAgICAgICAgICAgICBpbmRleCA9IGk7XHJcblx0ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICAgICAgcmV0dXJuIGluZGV4O1xyXG5cdCAgICB9O1xyXG5cdCAgICBVdGlscy5maW5kID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIHZhciBpbmRleCA9IFV0aWxzLmZpbmRJbmRleChwcmVkaWNhdGUsIHhzKTtcclxuXHQgICAgICAgIHJldHVybiB4c1tpbmRleF07XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLnJlbW92ZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHhzKSB7XHJcblx0ICAgICAgICB2YXIgaW5kZXggPSBVdGlscy5maW5kSW5kZXgocHJlZGljYXRlLCB4cyk7XHJcblx0ICAgICAgICB4cy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvLyBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9hc3NpZ25cclxuXHQgICAgLy8gVE9ETzogcmVwbGFjZSBpbiBmYXZvciBvZiB1c2luZyBwb2x5ZmlsbFxyXG5cdCAgICBVdGlscy5hc3NpZ24gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG5cdCAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuXHQgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIHRhcmdldCA9IGFyZ3NbMF07XHJcblx0ICAgICAgICAndXNlIHN0cmljdCc7XHJcblx0ICAgICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQgfHwgdGFyZ2V0ID09PSBudWxsKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0Jyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XHJcblx0ICAgICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgYXJndW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cdCAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdO1xyXG5cdCAgICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcclxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgbmV4dEtleSBpbiBzb3VyY2UpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkobmV4dEtleSkpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSBzb3VyY2VbbmV4dEtleV07XHJcblx0ICAgICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gVXRpbHM7XHJcblx0fSgpKTtcclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcblx0ZXhwb3J0cy5kZWZhdWx0ID0gVXRpbHM7XHJcblxuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xyXG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcclxuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuXHR9O1xyXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgUmVwb3J0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuXHQgICAgX19leHRlbmRzKFJlcG9ydCwgX3N1cGVyKTtcclxuXHQgICAgZnVuY3Rpb24gUmVwb3J0KCkge1xyXG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0ICAgIH1cclxuXHQgICAgUmVwb3J0LnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IF9zdXBlci5wcm90b3R5cGUuZ2V0RW1iZWRVcmwuY2FsbCh0aGlzKTtcclxuXHQgICAgICAgIC8vIFRPRE86IE5lZWQgc2FmZSB3YXkgdG8gYWRkIHVybCBwYXJhbWV0ZXJzLlxyXG5cdCAgICAgICAgLy8gV2UgYXJlIGFzc3VtaW5nIGVtYmVkVXJscyB1c2UgcXVlcnkgcGFyYW1ldGVycyB0byBzdXBwbHkgaWQgb2YgdmlzdWFsXHJcblx0ICAgICAgICAvLyBzbyBtdXN0IHByZWZpeCB3aXRoICcmJy5cclxuXHQgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmZpbHRlclBhbmVFbmFibGVkKSB7XHJcblx0ICAgICAgICAgICAgZW1iZWRVcmwgKz0gXCImZmlsdGVyUGFuZUVuYWJsZWQ9ZmFsc2VcIjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcclxuXHQgICAgfTtcclxuXHQgICAgUmVwb3J0LnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKG9wdGlvbnMsIHJlcXVpcmVJZCkge1xyXG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCA9PT0gdm9pZCAwKSB7IHJlcXVpcmVJZCA9IGZhbHNlOyB9XHJcblx0ICAgICAgICBpZiAocmVxdWlyZUlkICYmIHR5cGVvZiBvcHRpb25zLmlkICE9PSAnc3RyaW5nJykge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImlkIG11c3QgYmUgc3BlY2lmaWVkIHdoZW4gbG9hZGluZyByZXBvcnRzIG9uIGV4aXN0aW5nIGVsZW1lbnRzLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBtZXNzYWdlID0ge1xyXG5cdCAgICAgICAgICAgIGFjdGlvbjogJ2xvYWRSZXBvcnQnLFxyXG5cdCAgICAgICAgICAgIHJlcG9ydElkOiBvcHRpb25zLmlkLFxyXG5cdCAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBudWxsXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkLmNhbGwodGhpcywgb3B0aW9ucywgcmVxdWlyZUlkLCBtZXNzYWdlKTtcclxuXHQgICAgfTtcclxuXHQgICAgUmVwb3J0Lm5hbWUgPSBcIlJlcG9ydFwiO1xyXG5cdCAgICByZXR1cm4gUmVwb3J0O1xyXG5cdH0oZW1iZWRfMS5kZWZhdWx0KSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFJlcG9ydDtcclxuXG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XHJcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG5cdH07XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciBUaWxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuXHQgICAgX19leHRlbmRzKFRpbGUsIF9zdXBlcik7XHJcblx0ICAgIGZ1bmN0aW9uIFRpbGUoKSB7XHJcblx0ICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHQgICAgfVxyXG5cdCAgICBUaWxlLnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IF9zdXBlci5wcm90b3R5cGUuZ2V0RW1iZWRVcmwuY2FsbCh0aGlzKTtcclxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcclxuXHQgICAgfTtcclxuXHQgICAgVGlsZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChvcHRpb25zLCByZXF1aXJlSWQpIHtcclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgPT09IHZvaWQgMCkgeyByZXF1aXJlSWQgPSBmYWxzZTsgfVxyXG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCAmJiB0eXBlb2Ygb3B0aW9ucy5pZCAhPT0gJ3N0cmluZycpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpZCBtdXN0IGJlIHNwZWNpZmllZCB3aGVuIGxvYWRpbmcgcmVwb3J0cyBvbiBleGlzdGluZyBlbGVtZW50cy5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgbWVzc2FnZSA9IHtcclxuXHQgICAgICAgICAgICBhY3Rpb246ICdsb2FkVGlsZScsXHJcblx0ICAgICAgICAgICAgdGlsZUlkOiBvcHRpb25zLmlkLFxyXG5cdCAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBudWxsXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkLmNhbGwodGhpcywgb3B0aW9ucywgcmVxdWlyZUlkLCBtZXNzYWdlKTtcclxuXHQgICAgfTtcclxuXHQgICAgVGlsZS5uYW1lID0gXCJUaWxlXCI7XHJcblx0ICAgIHJldHVybiBUaWxlO1xyXG5cdH0oZW1iZWRfMS5kZWZhdWx0KSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFRpbGU7XHJcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBvd2VyYmkuanMubWFwIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
