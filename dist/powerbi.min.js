!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o=n(1);window.Powerbi=o["default"],window.powerbi=new o["default"]},function(e,t,n){"use strict";var o=n(2),r=n(4),i=n(5),s=n(3),a=function(){function e(t){void 0===t&&(t={}),this.embeds=[],window.addEventListener("message",this.onReceiveMessage.bind(this),!1),this.config=s["default"].assign({},e.defaultConfig,t),this.config.autoEmbedOnContentLoaded&&this.enableAutoEmbed()}return e.prototype.init=function(e){var t=this;e=e&&e instanceof HTMLElement?e:document.body;var n=Array.prototype.slice.call(e.querySelectorAll("["+o["default"].embedUrlAttribute+"]"));n.forEach(function(e){return t.embed(e)})},e.prototype.embed=function(e,t){void 0===t&&(t={});var n,o=e;return n=o.powerBiEmbed?this.embedExisting(o,t):this.embedNew(o,t)},e.prototype.embedNew=function(t,n){var i=this,a=n.type||t.getAttribute(o["default"].typeAttribute);if(!a)throw new Error("Attempted to embed using config "+JSON.stringify(n)+" on element "+t.outerHTML+", but could not determine what type of component to embed. You must specify a type in the configuration or as an attribute such as '"+o["default"].typeAttribute+'="'+r["default"].name.toLowerCase()+"\"'.");n.type=a;var u=s["default"].find(function(e){return a===e.name.toLowerCase()},e.components);if(!u)throw new Error("Attempted to embed component of type: "+a+" but did not find any matching component.  Please verify the type you specified is intended.");n.getGlobalAccessToken=function(){return i.accessToken};var c=new u(t,n);return t.powerBiEmbed=c,this.embeds.push(c),c},e.prototype.embedExisting=function(e,t){var n=s["default"].find(function(t){return t.element===e},this.embeds);if(!n)throw new Error("Attempted to embed using config "+JSON.stringify(t)+" on element "+e.outerHTML+" which already has embedded comopnent associated, but could not find the existing comopnent in the list of active components. This could indicate the embeds list is out of sync with the DOM, or the component is referencing the incorrect HTML element.");return n.load(t,!0),n},e.prototype.enableAutoEmbed=function(){var e=this;window.addEventListener("DOMContentLoaded",function(t){return e.init(document.body)},!1)},e.prototype.get=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");return t.powerBiEmbed},e.prototype.reset=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");s["default"].remove(function(e){return e===t.powerBiEmbed},this.embeds),delete t.powerBiEmbed;var n=e.querySelector("iframe");n&&n.remove()},e.prototype.onReceiveMessage=function(t){if(t)try{var n=s["default"].find(function(e){return t.source===e.iframe.contentWindow},this.embeds);if(n){var o="string"==typeof t.data?JSON.parse(t.data):t.data;s["default"].raiseCustomEvent(n.element,e.eventMap[o.event],o)}}catch(r){if("function"!=typeof this.config.onError)throw r;this.config.onError.call(window,r)}},e.components=[i["default"],r["default"]],e.eventMap={tileClicked:"tile-click",tileLoaded:"tile-load",reportPageLoaded:"report-load"},e.defaultConfig={autoEmbedOnContentLoaded:!1,onError:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return console.log(e[0],e.slice(1))}},e}();t.PowerBi=a,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a},function(e,t,n){"use strict";var o=n(3),r=function(){function e(t,n){var r=this;this.element=t,this.options=o["default"].assign({},e.defaultOptions,n),this.options.accessToken=this.getAccessToken(),this.options.embedUrl=this.getEmbedUrl();var i='<iframe style="width:100%;height:100%;" src="'+this.options.embedUrl+'" scrolling="no" allowfullscreen="true"></iframe>';this.element.innerHTML=i,this.iframe=this.element.childNodes[0],this.iframe.addEventListener("load",function(){return r.load(r.options,!1)},!1)}return e.prototype.load=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=null),!n)throw new Error("You called load without providing message properties from the concrete embeddable class.");var r={accessToken:e.accessToken};o["default"].assign(n,r);var i={message:n};o["default"].raiseCustomEvent(this.element,i.message.action,i),this.iframe.contentWindow.postMessage(JSON.stringify(i.message),"*")},e.prototype.getAccessToken=function(){var t=this.options.accessToken||this.element.getAttribute(e.accessTokenAttribute)||this.options.getGlobalAccessToken();if(!t)throw new Error("No access token was found for element. You must specify an access token directly on the element using attribute '"+e.accessTokenAttribute+"' or specify a global token at: powerbi.accessToken.");return t},e.prototype.getEmbedUrl=function(){var t=this.options.embedUrl||this.element.getAttribute(e.embedUrlAttribute);if("string"!=typeof t||0===t.length)throw new Error("Embed Url is required, but it was not found. You must provide an embed url either as part of embed configuration or as attribute '"+e.embedUrlAttribute+"'.");return t},e.prototype.fullscreen=function(){var e=this.iframe.requestFullscreen||this.iframe.msRequestFullscreen||this.iframe.mozRequestFullScreen||this.iframe.webkitRequestFullscreen;e.call(this.iframe)},e.prototype.exitFullscreen=function(){if(this.isFullscreen(this.iframe)){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;e.call(document)}},e.prototype.isFullscreen=function(e){var t=["fullscreenElement","webkitFullscreenElement","mozFullscreenScreenElement","msFullscreenElement"];return t.some(function(t){return document[t]===e})},e.embedUrlAttribute="powerbi-embed-url",e.accessTokenAttribute="powerbi-access-token",e.typeAttribute="powerbi-type",e.defaultOptions={filterPaneEnabled:!0},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t){"use strict";var n=function(){function e(){}return e.raiseCustomEvent=function(e,t,n){var o;if("function"==typeof CustomEvent?o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(o),!o.defaultPrevented&&o.returnValue){var r="on"+t.replace("-",""),i=e.getAttribute(r);i&&eval.call(e,i)}},e.findIndex=function(e,t){if(!Array.isArray(t))throw new Error("You attempted to call find with second parameter that was not an array. You passed: "+t);var n;return t.some(function(t,o){return e(t)?(n=o,!0):void 0}),n},e.find=function(t,n){var o=e.findIndex(t,n);return n[o]},e.remove=function(t,n){var o=e.findIndex(t,n);n.splice(o,1)},e.assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e[0];if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}return o},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return this.options.filterPaneEnabled||(t+="&filterPaneEnabled=false"),t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadReport",reportId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadTile",tileId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvd2VyYmkuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiY29yZV8xIiwid2luZG93IiwiUG93ZXJiaSIsInBvd2VyYmkiLCJlbWJlZF8xIiwicmVwb3J0XzEiLCJ0aWxlXzEiLCJ1dGlsXzEiLCJQb3dlckJpIiwiY29uZmlnIiwidGhpcyIsImVtYmVkcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiYmluZCIsImFzc2lnbiIsImRlZmF1bHRDb25maWciLCJhdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQiLCJlbmFibGVBdXRvRW1iZWQiLCJwcm90b3R5cGUiLCJpbml0IiwiY29udGFpbmVyIiwiX3RoaXMiLCJIVE1MRWxlbWVudCIsImRvY3VtZW50IiwiYm9keSIsImVsZW1lbnRzIiwiQXJyYXkiLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbWJlZFVybEF0dHJpYnV0ZSIsImZvckVhY2giLCJlbGVtZW50IiwiZW1iZWQiLCJjb21wb25lbnQiLCJwb3dlckJpRWxlbWVudCIsInBvd2VyQmlFbWJlZCIsImVtYmVkRXhpc3RpbmciLCJlbWJlZE5ldyIsImNvbXBvbmVudFR5cGUiLCJ0eXBlIiwiZ2V0QXR0cmlidXRlIiwidHlwZUF0dHJpYnV0ZSIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsIm91dGVySFRNTCIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsIkNvbXBvbmVudCIsImZpbmQiLCJjb21wb25lbnRzIiwiZ2V0R2xvYmFsQWNjZXNzVG9rZW4iLCJhY2Nlc3NUb2tlbiIsInB1c2giLCJ4IiwibG9hZCIsImV2ZW50IiwiZ2V0IiwicmVzZXQiLCJyZW1vdmUiLCJpZnJhbWUiLCJxdWVyeVNlbGVjdG9yIiwic291cmNlIiwiY29udGVudFdpbmRvdyIsIm1lc3NhZ2VEYXRhIiwiZGF0YSIsInBhcnNlIiwicmFpc2VDdXN0b21FdmVudCIsImV2ZW50TWFwIiwiZSIsIm9uRXJyb3IiLCJ0aWxlQ2xpY2tlZCIsInRpbGVMb2FkZWQiLCJyZXBvcnRQYWdlTG9hZGVkIiwiYXJncyIsIl9pIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJFbWJlZCIsIm9wdGlvbnMiLCJkZWZhdWx0T3B0aW9ucyIsImdldEFjY2Vzc1Rva2VuIiwiZW1iZWRVcmwiLCJnZXRFbWJlZFVybCIsImlmcmFtZUh0bWwiLCJpbm5lckhUTUwiLCJjaGlsZE5vZGVzIiwicmVxdWlyZUlkIiwibWVzc2FnZSIsImJhc2VNZXNzYWdlIiwiYWN0aW9uIiwicG9zdE1lc3NhZ2UiLCJhY2Nlc3NUb2tlbkF0dHJpYnV0ZSIsImZ1bGxzY3JlZW4iLCJyZXF1ZXN0RnVsbFNjcmVlbiIsInJlcXVlc3RGdWxsc2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsIm1velJlcXVlc3RGdWxsU2NyZWVuIiwid2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4iLCJleGl0RnVsbHNjcmVlbiIsImlzRnVsbHNjcmVlbiIsIm1vekNhbmNlbEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJzb21lIiwib3B0aW9uIiwiZmlsdGVyUGFuZUVuYWJsZWQiLCJVdGlscyIsImV2ZW50TmFtZSIsImV2ZW50RGF0YSIsImN1c3RvbUV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsImRlZmF1bHRQcmV2ZW50ZWQiLCJyZXR1cm5WYWx1ZSIsImlubGluZUV2ZW50QXR0ciIsInJlcGxhY2UiLCJpbmxpbmVTY3JpcHQiLCJldmFsIiwiZmluZEluZGV4IiwicHJlZGljYXRlIiwieHMiLCJpc0FycmF5IiwiaW5kZXgiLCJpIiwic3BsaWNlIiwidGFyZ2V0IiwidW5kZWZpbmVkIiwiVHlwZUVycm9yIiwib3V0cHV0IiwibmV4dEtleSIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiZCIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiUmVwb3J0IiwiX3N1cGVyIiwiYXBwbHkiLCJyZXBvcnRJZCIsIlRpbGUiLCJ0aWxlSWQiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdBS1QsUUFBU0MsR0FBb0JDLEdBRzVCLEdBQUdDLEVBQWlCRCxHQUNuQixNQUFPQyxHQUFpQkQsR0FBVUUsT0FHbkMsSUFBSUMsR0FBU0YsRUFBaUJELElBQzdCRSxXQUNBRSxHQUFJSixFQUNKSyxRQUFRLEVBVVQsT0FOQVAsR0FBUUUsR0FBVU0sS0FBS0gsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0gsR0FHL0RJLEVBQU9FLFFBQVMsRUFHVEYsRUFBT0QsUUF2QmYsR0FBSUQsS0FxQ0osT0FUQUYsR0FBb0JRLEVBQUlULEVBR3hCQyxFQUFvQlMsRUFBSVAsRUFHeEJGLEVBQW9CVSxFQUFJLEdBR2pCVixFQUFvQixLQUsvQixTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQixZQUNBLElBQUlXLEdBQVNYLEVBQW9CLEVBTWpDWSxRQUFPQyxRQUFVRixFQUFBQSxXQUNqQkMsT0FBT0UsUUFBVSxHQUFJSCxHQUFBQSxZQUtoQixTQUFTUCxFQUFRRCxFQUFTSCxHQUUvQixZQUNBLElBQUllLEdBQVVmLEVBQW9CLEdBQzlCZ0IsRUFBV2hCLEVBQW9CLEdBQy9CaUIsRUFBU2pCLEVBQW9CLEdBQzdCa0IsRUFBU2xCLEVBQW9CLEdBQzdCbUIsRUFBVyxXQUNYLFFBQVNBLEdBQVFDLEdBQ0UsU0FBWEEsSUFBcUJBLE1BQ3pCQyxLQUFLQyxVQUNMVixPQUFPVyxpQkFBaUIsVUFBV0YsS0FBS0csaUJBQWlCQyxLQUFLSixPQUFPLEdBRXJFQSxLQUFLRCxPQUFTRixFQUFBQSxXQUFlUSxV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UUQsRUFBU0gsR0FFL0IsWUFDQSxJQUFJMEosR0FBYXJJLE1BQVFBLEtBQUtxSSxXQUFjLFNBQVVDLEVBQUdDLEdBRXJELFFBQVNDLEtBQU94SSxLQUFLeUksWUFBY0gsRUFEbkMsSUFBSyxHQUFJakosS0FBS2tKLEdBQU9BLEVBQUVILGVBQWUvSSxLQUFJaUosRUFBRWpKLEdBQUtrSixFQUFFbEosR0FFbkRpSixHQUFFN0gsVUFBa0IsT0FBTjhILEVBQWFoRSxPQUFPbUUsT0FBT0gsSUFBTUMsRUFBRy9ILFVBQVk4SCxFQUFFOUgsVUFBVyxHQUFJK0gsS0FFL0U5SSxFQUFVZixFQUFvQixHQUM5Qm9LLEVBQVEsU0FBVUgsR0FFbEIsUUFBU0csS0FDTEgsRUFBT0MsTUFBTTdJLEtBQU1tRSxXQWtCdkIsTUFwQkFrRSxHQUFVVSxFQUFNSCxHQUloQkcsRUFBS3RJLFVBQVVzRSxZQUFjLFdBQ3pCLEdBQUlELEdBQVc4RCxFQUFPbkksVUFBVXNFLFlBQVk3RixLQUFLYyxLQUNqRCxPQUFPOEUsSUFFWGlFLEVBQUt0SSxVQUFVcUMsS0FBTyxTQUFVNkIsRUFBU1EsR0FFckMsR0FEa0IsU0FBZEEsSUFBd0JBLEdBQVksR0FDcENBLEdBQW1DLGdCQUFmUixHQUFRM0YsR0FDNUIsS0FBTSxJQUFJaUQsT0FBTSxrRUFFcEIsSUFBSW1ELElBQ0FFLE9BQVEsV0FDUjBELE9BQVFyRSxFQUFRM0YsR0FDaEIyRCxZQUFhLEtBRWpCaUcsR0FBT25JLFVBQVVxQyxLQUFLNUQsS0FBS2MsS0FBTTJFLEVBQVNRLEVBQVdDLElBRWxEMkQsR0FDVHJKLEVBQUFBLFdBQ0Y2RSxRQUFPQyxlQUFlMUYsRUFBUyxjQUFnQjJGLE9BQU8sSUFDdEQzRixFQUFBQSxXQUFrQmlLIiwiZmlsZSI6InBvd2VyYmkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xyXG5cdC8qKlxyXG5cdCAqIE1ha2UgUG93ZXJCaSBhdmFpbGFibGUgb24gZ2xvYmFsIG9iamVjdCBmb3IgdXNlIGluIGFwcHMgd2l0aG91dCBtb2R1bGUgbG9hZGluZyBzdXBwb3J0LlxyXG5cdCAqIFNhdmUgY2xhc3MgdG8gYWxsb3cgY3JlYXRpbmcgYW4gaW5zdGFuY2Ugb2YgdGhlIHNlcnZpY2UuXHJcblx0ICogQ3JlYXRlIGluc3RhbmNlIG9mIGNsYXNzIHdpdGggZGVmYXVsdCBjb25maWcgZm9yIG5vcm1hbCB1c2FnZS5cclxuXHQgKi9cclxuXHR3aW5kb3cuUG93ZXJiaSA9IGNvcmVfMS5kZWZhdWx0O1xyXG5cdHdpbmRvdy5wb3dlcmJpID0gbmV3IGNvcmVfMS5kZWZhdWx0KCk7XHJcblxuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciByZXBvcnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XHJcblx0dmFyIHRpbGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XHJcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcblx0dmFyIFBvd2VyQmkgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBQb3dlckJpKGNvbmZpZykge1xyXG5cdCAgICAgICAgaWYgKGNvbmZpZyA9PT0gdm9pZCAwKSB7IGNvbmZpZyA9IHt9OyB9XHJcblx0ICAgICAgICB0aGlzLmVtYmVkcyA9IFtdO1xyXG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uUmVjZWl2ZU1lc3NhZ2UuYmluZCh0aGlzKSwgZmFsc2UpO1xyXG5cdCAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gT2JqZWN0LmFzc2lnbiBpcyBhdmFpbGFibGUuXHJcblx0ICAgICAgICB0aGlzLmNvbmZpZyA9IHV0aWxfMS5kZWZhdWx0LmFzc2lnbih7fSwgUG93ZXJCaS5kZWZhdWx0Q29uZmlnLCBjb25maWcpO1xyXG5cdCAgICAgICAgaWYgKHRoaXMuY29uZmlnLmF1dG9FbWJlZE9uQ29udGVudExvYWRlZCkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuZW5hYmxlQXV0b0VtYmVkKCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH1cclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIERPTUNvbnRlbnRMb2FkZWQgd2hpY2ggc2VhcmNoZXMgRE9NIGZvciBlbGVtZW50cyBoYXZpbmcgJ3Bvd2VyYmktZW1iZWQtdXJsJyBhdHRyaWJ1dGVcclxuXHQgICAgICogYW5kIGF1dG9tYXRpY2FsbHkgYXR0ZW1wdHMgdG8gZW1iZWQgYSBwb3dlcmJpIGNvbXBvbmVudCBiYXNlZCBvbiBpbmZvcm1hdGlvbiBmcm9tIHRoZSBhdHRyaWJ1dGVzLlxyXG5cdCAgICAgKiBPbmx5IHJ1bnMgaWYgYGNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWRgIGlzIHRydWUgd2hlbiB0aGUgc2VydmljZSBpcyBjcmVhdGVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBjb250YWluZXIgPSAoY29udGFpbmVyICYmIGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSA/IGNvbnRhaW5lciA6IGRvY3VtZW50LmJvZHk7XHJcblx0ICAgICAgICB2YXIgZWxlbWVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIltcIiArIGVtYmVkXzEuZGVmYXVsdC5lbWJlZFVybEF0dHJpYnV0ZSArIFwiXVwiKSk7XHJcblx0ICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBfdGhpcy5lbWJlZChlbGVtZW50KTsgfSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBHaXZlbiBhbiBodG1sIGVsZW1lbnQgZW1iZWQgY29tcG9uZW50IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb24uXHJcblx0ICAgICAqIElmIGNvbXBvbmVudCBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgYW5kIGF0dGFjaGVkIHRvIGVsZW1lbnQgcmUtdXNlIGNvbXBvbmVudCBpbnN0YW5jZSBhbmQgZXhpc3RpbmcgaWZyYW1lLFxyXG5cdCAgICAgKiBvdGhlcndpc2UgY3JlYXRlIGEgbmV3IGNvbXBvbmVudCBpbnN0YW5jZVxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZW1iZWQgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29uZmlnKSB7XHJcblx0ICAgICAgICBpZiAoY29uZmlnID09PSB2b2lkIDApIHsgY29uZmlnID0ge307IH1cclxuXHQgICAgICAgIHZhciBjb21wb25lbnQ7XHJcblx0ICAgICAgICB2YXIgcG93ZXJCaUVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgaWYgKHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZCkge1xyXG5cdCAgICAgICAgICAgIGNvbXBvbmVudCA9IHRoaXMuZW1iZWRFeGlzdGluZyhwb3dlckJpRWxlbWVudCwgY29uZmlnKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIGNvbXBvbmVudCA9IHRoaXMuZW1iZWROZXcocG93ZXJCaUVsZW1lbnQsIGNvbmZpZyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2l2ZW4gYW4gaHRtbCBlbGVtZW50IGVtYmVkIGNvbXBvbmVudCBiYXNlIGNvbmZpZ3VyYXRpb24uXHJcblx0ICAgICAqIFNhdmUgY29tcG9uZW50IGluc3RhbmNlIG9uIGVsZW1lbnQgZm9yIGxhdGVyIGxvb2t1cC5cclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVtYmVkTmV3ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIHZhciBjb21wb25lbnRUeXBlID0gY29uZmlnLnR5cGUgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoZW1iZWRfMS5kZWZhdWx0LnR5cGVBdHRyaWJ1dGUpO1xyXG5cdCAgICAgICAgaWYgKCFjb21wb25lbnRUeXBlKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGVtYmVkIHVzaW5nIGNvbmZpZyBcIiArIEpTT04uc3RyaW5naWZ5KGNvbmZpZykgKyBcIiBvbiBlbGVtZW50IFwiICsgZWxlbWVudC5vdXRlckhUTUwgKyBcIiwgYnV0IGNvdWxkIG5vdCBkZXRlcm1pbmUgd2hhdCB0eXBlIG9mIGNvbXBvbmVudCB0byBlbWJlZC4gWW91IG11c3Qgc3BlY2lmeSBhIHR5cGUgaW4gdGhlIGNvbmZpZ3VyYXRpb24gb3IgYXMgYW4gYXR0cmlidXRlIHN1Y2ggYXMgJ1wiICsgZW1iZWRfMS5kZWZhdWx0LnR5cGVBdHRyaWJ1dGUgKyBcIj1cXFwiXCIgKyByZXBvcnRfMS5kZWZhdWx0Lm5hbWUudG9Mb3dlckNhc2UoKSArIFwiXFxcIicuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLy8gU2F2ZSB0eXBlIG9uIGNvbmZpZ3VyYXRpb24gc28gaXQgY2FuIGJlIHJlZmVyZW5jZWQgbGF0ZXIgYXQga25vd24gbG9jYXRpb25cclxuXHQgICAgICAgIGNvbmZpZy50eXBlID0gY29tcG9uZW50VHlwZTtcclxuXHQgICAgICAgIHZhciBDb21wb25lbnQgPSB1dGlsXzEuZGVmYXVsdC5maW5kKGZ1bmN0aW9uIChjb21wb25lbnQpIHsgcmV0dXJuIGNvbXBvbmVudFR5cGUgPT09IGNvbXBvbmVudC5uYW1lLnRvTG93ZXJDYXNlKCk7IH0sIFBvd2VyQmkuY29tcG9uZW50cyk7XHJcblx0ICAgICAgICBpZiAoIUNvbXBvbmVudCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBlbWJlZCBjb21wb25lbnQgb2YgdHlwZTogXCIgKyBjb21wb25lbnRUeXBlICsgXCIgYnV0IGRpZCBub3QgZmluZCBhbnkgbWF0Y2hpbmcgY29tcG9uZW50LiAgUGxlYXNlIHZlcmlmeSB0aGUgdHlwZSB5b3Ugc3BlY2lmaWVkIGlzIGludGVuZGVkLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIC8vIFRPRE86IENvbnNpZGVyIHJlbW92aW5nIGluIGZhdm9yIG9mIHBhc3NpbmcgcmVmZXJlbmNlIHRvIGB0aGlzYCBpbiBjb25zdHJ1Y3RvclxyXG5cdCAgICAgICAgLy8gVGhlIGdldEdsb2JhbEFjY2Vzc1Rva2VuIGZ1bmN0aW9uIGlzIG9ubHkgaGVyZSBzbyB0aGF0IHRoZSBjb21wb25lbnRzIChUaWxlIHwgUmVwb3J0KSBjYW4gZ2V0IHRoZSBnbG9iYWwgYWNjZXNzIHRva2VuIHdpdGhvdXQgbmVlZGluZyByZWZlcmVuY2VcclxuXHQgICAgICAgIC8vIHRvIHRoZSBzZXJ2aWNlIHRoYXQgdGhleSBhcmUgcmVnaXN0ZXJlZCB3aXRoaW4gYmVjYXVlcyBpdCBjcmVhdGVzIGNpcmN1bGFyIGRlcGVuZGVuY2llc1xyXG5cdCAgICAgICAgY29uZmlnLmdldEdsb2JhbEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYWNjZXNzVG9rZW47IH07XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50ID0gbmV3IENvbXBvbmVudChlbGVtZW50LCBjb25maWcpO1xyXG5cdCAgICAgICAgZWxlbWVudC5wb3dlckJpRW1iZWQgPSBjb21wb25lbnQ7XHJcblx0ICAgICAgICB0aGlzLmVtYmVkcy5wdXNoKGNvbXBvbmVudCk7XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbWJlZEV4aXN0aW5nID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgdmFyIGNvbXBvbmVudCA9IHV0aWxfMS5kZWZhdWx0LmZpbmQoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguZWxlbWVudCA9PT0gZWxlbWVudDsgfSwgdGhpcy5lbWJlZHMpO1xyXG5cdCAgICAgICAgaWYgKCFjb21wb25lbnQpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZW1iZWQgdXNpbmcgY29uZmlnIFwiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSArIFwiIG9uIGVsZW1lbnQgXCIgKyBlbGVtZW50Lm91dGVySFRNTCArIFwiIHdoaWNoIGFscmVhZHkgaGFzIGVtYmVkZGVkIGNvbW9wbmVudCBhc3NvY2lhdGVkLCBidXQgY291bGQgbm90IGZpbmQgdGhlIGV4aXN0aW5nIGNvbW9wbmVudCBpbiB0aGUgbGlzdCBvZiBhY3RpdmUgY29tcG9uZW50cy4gVGhpcyBjb3VsZCBpbmRpY2F0ZSB0aGUgZW1iZWRzIGxpc3QgaXMgb3V0IG9mIHN5bmMgd2l0aCB0aGUgRE9NLCBvciB0aGUgY29tcG9uZW50IGlzIHJlZmVyZW5jaW5nIHRoZSBpbmNvcnJlY3QgSFRNTCBlbGVtZW50LlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGNvbXBvbmVudC5sb2FkKGNvbmZpZywgdHJ1ZSk7XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogQWRkcyBldmVudCBoYW5kbGVyIGZvciBET01Db250ZW50TG9hZGVkIHdoaWNoIGZpbmRzIGFsbCBlbGVtZW50cyBpbiBET00gd2l0aCBhdHRyaWJ1dGUgcG93ZXJiaS1lbWJlZC11cmxcclxuXHQgICAgICogdGhlbiBhdHRlbXB0cyB0byBpbml0aWF0ZSB0aGUgZW1iZWQgcHJvY2VzcyBiYXNlZCBvbiBkYXRhIGZyb20gb3RoZXIgcG93ZXJiaS0qIGF0dHJpYnV0ZXMuXHJcblx0ICAgICAqIChUaGlzIGlzIHVzdWFsbHkgb25seSB1c2VmdWwgZm9yIGFwcGxpY2F0aW9ucyByZW5kZXJlZCBvbiBieSB0aGUgc2VydmVyIHNpbmNlIGFsbCB0aGUgZGF0YSBuZWVkZWQgd2lsbCBiZSBhdmFpbGFibGUgYnkgdGhlIHRpbWUgdGhlIGhhbmRsZXIgaXMgY2FsbGVkLilcclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVuYWJsZUF1dG9FbWJlZCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaW5pdChkb2N1bWVudC5ib2R5KTsgfSwgZmFsc2UpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmV0dXJucyBpbnN0YW5jZSBvZiBjb21wb25lbnQgYXNzb2NpYXRlZCB3aXRoIGVsZW1lbnQuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcclxuXHQgICAgICAgIGlmICghcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBnZXQgYW4gaW5zdGFuY2Ugb2YgcG93ZXJiaSBjb21wb25lbnQgYXNzb2NpYXRlZCB3aXRoIGVsZW1lbnQ6IFwiICsgZWxlbWVudC5vdXRlckhUTUwgKyBcIiBidXQgdGhlcmUgd2FzIG5vIGFzc29jaWF0ZWQgaW5zdGFuY2UuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdpdmVuIGFuIGh0bWwgZWxlbWVudCB3aGljaCBoYXMgY29tcG9uZW50IGVtYmVkZGVkIHdpdGhpbiBpdCwgcmVtb3ZlIHRoZSBjb21wb25lbnQgZnJvbSBsaXN0IG9mIGVtYmVkcywgcmVtb3ZlIGFzc29jaWF0aW9uIHdpdGggY29tcG9uZW50LCBhbmQgcmVtb3ZlIHRoZSBpZnJhbWUuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcblx0ICAgICAgICB2YXIgcG93ZXJCaUVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgaWYgKCFwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXR0ZW1wdGVkIHRvIGdldCBhbiBpbnN0YW5jZSBvZiBwb3dlcmJpIGNvbXBvbmVudCBhc3NvY2lhdGVkIHdpdGggZWxlbWVudDogXCIgKyBlbGVtZW50Lm91dGVySFRNTCArIFwiIGJ1dCB0aGVyZSB3YXMgbm8gYXNzb2NpYXRlZCBpbnN0YW5jZS5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvKiogUmVtb3ZlIGNvbXBvbmVudCBmcm9tIGludGVybmFsIGxpc3QgKi9cclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LnJlbW92ZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geCA9PT0gcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkOyB9LCB0aGlzLmVtYmVkcyk7XHJcblx0ICAgICAgICAvKiogRGVsZXRlIHByb3BlcnR5IGZyb20gaHRtbCBlbGVtZW50ICovXHJcblx0ICAgICAgICBkZWxldGUgcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkO1xyXG5cdCAgICAgICAgLyoqIFJlbW92ZSBpZnJhbWUgZnJvbSBlbGVtZW50ICovXHJcblx0ICAgICAgICB2YXIgaWZyYW1lID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdpZnJhbWUnKTtcclxuXHQgICAgICAgIGlmIChpZnJhbWUpIHtcclxuXHQgICAgICAgICAgICBpZnJhbWUucmVtb3ZlKCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBIYW5kbGVyIGZvciB3aW5kb3cgbWVzc2FnZSBldmVudC5cclxuXHQgICAgICogUGFyc2VzIGV2ZW50IGRhdGEgYXMganNvbiBhbmQgaWYgaXQgY2FtZSBmcm9tIGFuIGlmcmFtZSB0aGF0IG1hdGNoZXMgb25lIGZyb20gYW4gZXhpc3RpbmcgZW1iZWRlZCBjb21wb25lbnQgcmUtZGlzcGF0Y2hlcyB0aGUgZXZlbnQgb24gdGhlIGlmcmFtZSdzIHBhcmVudCBlbGVtZW50XHJcblx0ICAgICAqIHRvIHNpbXVsYXRlIHRoZSBldmVudCBidWJibGluZyB0aHJvdWdoIHRoZSB0d28gc2VwYXJhdGUgd2luZG93cyAvIERPTXMuXHJcblx0ICAgICAqXHJcblx0ICAgICAqIElmIGFuIGVycm9yIG9jY3VycyB3aGVuIHBhcnNpbmcgZXZlbnQuZGF0YSBjYWxsIGVycm9yIGhhbmRsZXIgcHJvdmlkZWQgZHVyaW5nIGNvbmZpZ3VyYXRpb24uXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5vblJlY2VpdmVNZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcblx0ICAgICAgICBpZiAoIWV2ZW50KSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdHJ5IHtcclxuXHQgICAgICAgICAgICAvLyBPbmx5IHJhaXNlIHRoZSBldmVudCBvbiB0aGUgZW1iZWQgdGhhdCBtYXRjaGVzIHRoZSBwb3N0IG1lc3NhZ2Ugb3JpZ2luXHJcblx0ICAgICAgICAgICAgdmFyIGVtYmVkID0gdXRpbF8xLmRlZmF1bHQuZmluZChmdW5jdGlvbiAoZW1iZWQpIHsgcmV0dXJuIGV2ZW50LnNvdXJjZSA9PT0gZW1iZWQuaWZyYW1lLmNvbnRlbnRXaW5kb3c7IH0sIHRoaXMuZW1iZWRzKTtcclxuXHQgICAgICAgICAgICBpZiAoZW1iZWQpIHtcclxuXHQgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VEYXRhID0gdHlwZW9mIGV2ZW50LmRhdGEgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShldmVudC5kYXRhKSA6IGV2ZW50LmRhdGE7XHJcblx0ICAgICAgICAgICAgICAgIHV0aWxfMS5kZWZhdWx0LnJhaXNlQ3VzdG9tRXZlbnQoZW1iZWQuZWxlbWVudCwgUG93ZXJCaS5ldmVudE1hcFttZXNzYWdlRGF0YS5ldmVudF0sIG1lc3NhZ2VEYXRhKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBjYXRjaCAoZSkge1xyXG5cdCAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5jb25maWcub25FcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdCAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5vbkVycm9yLmNhbGwod2luZG93LCBlKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgICAgIHRocm93IGU7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogTGlzdCBvZiBjb21wb25lbnRzIHRoaXMgc2VydmljZSBjYW4gZW1iZWQuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLmNvbXBvbmVudHMgPSBbXHJcblx0ICAgICAgICB0aWxlXzEuZGVmYXVsdCxcclxuXHQgICAgICAgIHJlcG9ydF8xLmRlZmF1bHRcclxuXHQgICAgXTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIE1hcHBpbmcgb2YgZXZlbnQgbmFtZXMgZnJvbSBpZnJhbWUgcG9zdE1lc3NhZ2UgdG8gdGhlaXIgbmFtZSBwZXJjaWV2ZWQgYnkgcGFyZW50IERPTS5cclxuXHQgICAgICogRXhhbXBsZTogVXNlciBjbGlja3Mgb24gZW1iZWRlZCByZXBvcnQgd2hpY2ggaXMgaW5zaWRlIGlmcmFtZS4gVGhlIGlmcmFtZSBjb2RlIHJlc2VuZHNcclxuXHQgICAgICogZXZlbnQgYXMgcG9zdE1lc3NhZ2Ugd2l0aCB7IGV2ZW50OiAncmVwb3J0Q2xpY2tlZCcsIC4uLiB9IGFuZCB0aGlzIG5hbWUgaXMgY29udmVydGVkIHRvIGh5cGhlbmF0ZWRcclxuXHQgICAgICogbmFtZSBhbmQgZGlzcGF0Y2hlZCBmcm9tIHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgaWZyYW1lIHRvIHNpbXVsYXRlIHRoZSBldmVudCBidWJibGluZyB0aHJvdWdoIHR3b1xyXG5cdCAgICAgKiBkaWZmZXJlbnQgd2luZG93cyAvIERPTXNcclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkuZXZlbnRNYXAgPSB7XHJcblx0ICAgICAgICAndGlsZUNsaWNrZWQnOiAndGlsZS1jbGljaycsXHJcblx0ICAgICAgICAndGlsZUxvYWRlZCc6ICd0aWxlLWxvYWQnLFxyXG5cdCAgICAgICAgJ3JlcG9ydFBhZ2VMb2FkZWQnOiAncmVwb3J0LWxvYWQnXHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBEZWZhdWx0IGNvbmZpZ3VyYXRpb24gZm9yIHNlcnZpY2UuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLmRlZmF1bHRDb25maWcgPSB7XHJcblx0ICAgICAgICBhdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQ6IGZhbHNlLFxyXG5cdCAgICAgICAgb25FcnJvcjogZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcblx0ICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuXHQgICAgICAgICAgICAgICAgYXJnc1tfaSAtIDBdID0gYXJndW1lbnRzW19pXTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGFyZ3NbMF0sIGFyZ3Muc2xpY2UoMSkpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gUG93ZXJCaTtcclxuXHR9KCkpO1xyXG5cdGV4cG9ydHMuUG93ZXJCaSA9IFBvd2VyQmk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFBvd2VyQmk7XHJcblxuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcblx0dmFyIEVtYmVkID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gRW1iZWQoZWxlbWVudCwgb3B0aW9ucykge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0ICAgICAgICAvLyBUT0RPOiBDaGFuZ2Ugd2hlbiBPYmplY3QuYXNzaWduIGlzIGF2YWlsYWJsZS5cclxuXHQgICAgICAgIHRoaXMub3B0aW9ucyA9IHV0aWxfMS5kZWZhdWx0LmFzc2lnbih7fSwgRW1iZWQuZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xyXG5cdCAgICAgICAgdGhpcy5vcHRpb25zLmFjY2Vzc1Rva2VuID0gdGhpcy5nZXRBY2Nlc3NUb2tlbigpO1xyXG5cdCAgICAgICAgdGhpcy5vcHRpb25zLmVtYmVkVXJsID0gdGhpcy5nZXRFbWJlZFVybCgpO1xyXG5cdCAgICAgICAgdmFyIGlmcmFtZUh0bWwgPSBcIjxpZnJhbWUgc3R5bGU9XFxcIndpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7XFxcIiBzcmM9XFxcIlwiICsgdGhpcy5vcHRpb25zLmVtYmVkVXJsICsgXCJcXFwiIHNjcm9sbGluZz1cXFwibm9cXFwiIGFsbG93ZnVsbHNjcmVlbj1cXFwidHJ1ZVxcXCI+PC9pZnJhbWU+XCI7XHJcblx0ICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gaWZyYW1lSHRtbDtcclxuXHQgICAgICAgIHRoaXMuaWZyYW1lID0gdGhpcy5lbGVtZW50LmNoaWxkTm9kZXNbMF07XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZS5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubG9hZChfdGhpcy5vcHRpb25zLCBmYWxzZSk7IH0sIGZhbHNlKTtcclxuXHQgICAgfVxyXG5cdCAgICAvKipcclxuXHQgICAgICogSGFuZGxlciBmb3Igd2hlbiB0aGUgaWZyYW1lIGhhcyBmaW5pc2hlZCBsb2FkaW5nIHRoZSBwb3dlcmJpIHBsYWNlaG9sZGVyIHBhZ2UuXHJcblx0ICAgICAqIFRoaXMgaXMgdXNlZCB0byBpbmplY3QgY29uZmlndXJhdGlvbiBvcHRpb25zIHN1Y2ggYXMgYWNjZXNzIHRva2VuLCBsb2FkQWN0aW9uLCBldGNcclxuXHQgICAgICogd2hpY2ggYWxsb3cgaWZyYW1lIHRvIGxvYWQgdGhlIGFjdHVhbCByZXBvcnQgd2l0aCBhdXRoZW50aWNhdGlvbi5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKG9wdGlvbnMsIHJlcXVpcmVJZCwgbWVzc2FnZSkge1xyXG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCA9PT0gdm9pZCAwKSB7IHJlcXVpcmVJZCA9IGZhbHNlOyB9XHJcblx0ICAgICAgICBpZiAobWVzc2FnZSA9PT0gdm9pZCAwKSB7IG1lc3NhZ2UgPSBudWxsOyB9XHJcblx0ICAgICAgICBpZiAoIW1lc3NhZ2UpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgY2FsbGVkIGxvYWQgd2l0aG91dCBwcm92aWRpbmcgbWVzc2FnZSBwcm9wZXJ0aWVzIGZyb20gdGhlIGNvbmNyZXRlIGVtYmVkZGFibGUgY2xhc3MuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIGJhc2VNZXNzYWdlID0ge1xyXG5cdCAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBvcHRpb25zLmFjY2Vzc1Rva2VuXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgdXRpbF8xLmRlZmF1bHQuYXNzaWduKG1lc3NhZ2UsIGJhc2VNZXNzYWdlKTtcclxuXHQgICAgICAgIHZhciBldmVudCA9IHtcclxuXHQgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgdXRpbF8xLmRlZmF1bHQucmFpc2VDdXN0b21FdmVudCh0aGlzLmVsZW1lbnQsIGV2ZW50Lm1lc3NhZ2UuYWN0aW9uLCBldmVudCk7XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KGV2ZW50Lm1lc3NhZ2UpLCAnKicpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2V0IGFjY2VzcyB0b2tlbiBmcm9tIGZpcnN0IGF2YWlsYWJsZSBsb2NhdGlvbjogb3B0aW9ucywgYXR0cmlidXRlLCBnbG9iYWwuXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZ2V0QWNjZXNzVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgYWNjZXNzVG9rZW4gPSB0aGlzLm9wdGlvbnMuYWNjZXNzVG9rZW4gfHwgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSkgfHwgdGhpcy5vcHRpb25zLmdldEdsb2JhbEFjY2Vzc1Rva2VuKCk7XHJcblx0ICAgICAgICBpZiAoIWFjY2Vzc1Rva2VuKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYWNjZXNzIHRva2VuIHdhcyBmb3VuZCBmb3IgZWxlbWVudC4gWW91IG11c3Qgc3BlY2lmeSBhbiBhY2Nlc3MgdG9rZW4gZGlyZWN0bHkgb24gdGhlIGVsZW1lbnQgdXNpbmcgYXR0cmlidXRlICdcIiArIEVtYmVkLmFjY2Vzc1Rva2VuQXR0cmlidXRlICsgXCInIG9yIHNwZWNpZnkgYSBnbG9iYWwgdG9rZW4gYXQ6IHBvd2VyYmkuYWNjZXNzVG9rZW4uXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2V0IGVtYmVkIHVybCBmcm9tIGZpcnN0IGF2YWlsYWJsZSBsb2NhdGlvbjogb3B0aW9ucywgYXR0cmlidXRlLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmdldEVtYmVkVXJsID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gdGhpcy5vcHRpb25zLmVtYmVkVXJsIHx8IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUpO1xyXG5cdCAgICAgICAgaWYgKHR5cGVvZiBlbWJlZFVybCAhPT0gJ3N0cmluZycgfHwgZW1iZWRVcmwubGVuZ3RoID09PSAwKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1iZWQgVXJsIGlzIHJlcXVpcmVkLCBidXQgaXQgd2FzIG5vdCBmb3VuZC4gWW91IG11c3QgcHJvdmlkZSBhbiBlbWJlZCB1cmwgZWl0aGVyIGFzIHBhcnQgb2YgZW1iZWQgY29uZmlndXJhdGlvbiBvciBhcyBhdHRyaWJ1dGUgJ1wiICsgRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUgKyBcIicuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGVtYmVkVXJsO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmVxdWVzdCB0aGUgYnJvd3NlciB0byBtYWtlIHRoZSBjb21wb25lbnRzIGlmcmFtZSBmdWxsc2NyZWVuLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgcmVxdWVzdEZ1bGxTY3JlZW4gPSB0aGlzLmlmcmFtZS5yZXF1ZXN0RnVsbHNjcmVlbiB8fCB0aGlzLmlmcmFtZS5tc1JlcXVlc3RGdWxsc2NyZWVuIHx8IHRoaXMuaWZyYW1lLm1velJlcXVlc3RGdWxsU2NyZWVuIHx8IHRoaXMuaWZyYW1lLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuO1xyXG5cdCAgICAgICAgcmVxdWVzdEZ1bGxTY3JlZW4uY2FsbCh0aGlzLmlmcmFtZSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBFeGl0IGZ1bGxzY3JlZW4uXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZXhpdEZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICBpZiAoIXRoaXMuaXNGdWxsc2NyZWVuKHRoaXMuaWZyYW1lKSkge1xyXG5cdCAgICAgICAgICAgIHJldHVybjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBleGl0RnVsbHNjcmVlbiA9IGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuIHx8IGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4gfHwgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4gfHwgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcclxuXHQgICAgICAgIGV4aXRGdWxsc2NyZWVuLmNhbGwoZG9jdW1lbnQpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmV0dXJuIHRydWUgaWYgaWZyYW1lIGlzIGZ1bGxzY3JlZW4sXHJcblx0ICAgICAqIG90aGVyd2lzZSByZXR1cm4gZmFsc2VcclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5pc0Z1bGxzY3JlZW4gPSBmdW5jdGlvbiAoaWZyYW1lKSB7XHJcblx0ICAgICAgICB2YXIgb3B0aW9ucyA9IFsnZnVsbHNjcmVlbkVsZW1lbnQnLCAnd2Via2l0RnVsbHNjcmVlbkVsZW1lbnQnLCAnbW96RnVsbHNjcmVlblNjcmVlbkVsZW1lbnQnLCAnbXNGdWxsc2NyZWVuRWxlbWVudCddO1xyXG5cdCAgICAgICAgcmV0dXJuIG9wdGlvbnMuc29tZShmdW5jdGlvbiAob3B0aW9uKSB7IHJldHVybiBkb2N1bWVudFtvcHRpb25dID09PSBpZnJhbWU7IH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICBFbWJlZC5lbWJlZFVybEF0dHJpYnV0ZSA9ICdwb3dlcmJpLWVtYmVkLXVybCc7XHJcblx0ICAgIEVtYmVkLmFjY2Vzc1Rva2VuQXR0cmlidXRlID0gJ3Bvd2VyYmktYWNjZXNzLXRva2VuJztcclxuXHQgICAgRW1iZWQudHlwZUF0dHJpYnV0ZSA9ICdwb3dlcmJpLXR5cGUnO1xyXG5cdCAgICAvKipcclxuXHQgICAgICogRGVmYXVsdCBvcHRpb25zIGZvciBlbWJlZGRhYmxlIGNvbXBvbmVudC5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLmRlZmF1bHRPcHRpb25zID0ge1xyXG5cdCAgICAgICAgZmlsdGVyUGFuZUVuYWJsZWQ6IHRydWVcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIEVtYmVkO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IEVtYmVkO1xyXG5cblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBVdGlscyA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIFV0aWxzKCkge1xyXG5cdCAgICB9XHJcblx0ICAgIFV0aWxzLnJhaXNlQ3VzdG9tRXZlbnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnROYW1lLCBldmVudERhdGEpIHtcclxuXHQgICAgICAgIHZhciBjdXN0b21FdmVudDtcclxuXHQgICAgICAgIGlmICh0eXBlb2YgQ3VzdG9tRXZlbnQgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudE5hbWUsIHtcclxuXHQgICAgICAgICAgICAgICAgZGV0YWlsOiBldmVudERhdGEsXHJcblx0ICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXHJcblx0ICAgICAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWVcclxuXHQgICAgICAgICAgICB9KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIGN1c3RvbUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XHJcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgdHJ1ZSwgZXZlbnREYXRhKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XHJcblx0ICAgICAgICBpZiAoY3VzdG9tRXZlbnQuZGVmYXVsdFByZXZlbnRlZCB8fCAhY3VzdG9tRXZlbnQucmV0dXJuVmFsdWUpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvLyBUT0RPOiBSZW1vdmUgdGhpcz8gU2hvdWxkIGJlIGJldHRlciB3YXkgdG8gaGFuZGxlIGV2ZW50cyB0aGFuIHVzaW5nIGV2YWw/XHJcblx0ICAgICAgICAvLyBXaGF0IGlzIHVzZSBjYXNlPyA8ZGl2IHBvd2VyYmktdHlwZT1cInJlcG9ydFwiIG9ubG9hZD1cImFsZXJ0KCdsb2FkZWQnKTtcIj48L2Rpdj5cclxuXHQgICAgICAgIHZhciBpbmxpbmVFdmVudEF0dHIgPSAnb24nICsgZXZlbnROYW1lLnJlcGxhY2UoJy0nLCAnJyk7XHJcblx0ICAgICAgICB2YXIgaW5saW5lU2NyaXB0ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoaW5saW5lRXZlbnRBdHRyKTtcclxuXHQgICAgICAgIGlmIChpbmxpbmVTY3JpcHQpIHtcclxuXHQgICAgICAgICAgICBldmFsLmNhbGwoZWxlbWVudCwgaW5saW5lU2NyaXB0KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgVXRpbHMuZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh4cykpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXR0ZW1wdGVkIHRvIGNhbGwgZmluZCB3aXRoIHNlY29uZCBwYXJhbWV0ZXIgdGhhdCB3YXMgbm90IGFuIGFycmF5LiBZb3UgcGFzc2VkOiBcIiArIHhzKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBpbmRleDtcclxuXHQgICAgICAgIHhzLnNvbWUoZnVuY3Rpb24gKHgsIGkpIHtcclxuXHQgICAgICAgICAgICBpZiAocHJlZGljYXRlKHgpKSB7XHJcblx0ICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfSk7XHJcblx0ICAgICAgICByZXR1cm4gaW5kZXg7XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLmZpbmQgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB4cykge1xyXG5cdCAgICAgICAgdmFyIGluZGV4ID0gVXRpbHMuZmluZEluZGV4KHByZWRpY2F0ZSwgeHMpO1xyXG5cdCAgICAgICAgcmV0dXJuIHhzW2luZGV4XTtcclxuXHQgICAgfTtcclxuXHQgICAgVXRpbHMucmVtb3ZlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIHZhciBpbmRleCA9IFV0aWxzLmZpbmRJbmRleChwcmVkaWNhdGUsIHhzKTtcclxuXHQgICAgICAgIHhzLnNwbGljZShpbmRleCwgMSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8vIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2Fzc2lnblxyXG5cdCAgICAvLyBUT0RPOiByZXBsYWNlIGluIGZhdm9yIG9mIHVzaW5nIHBvbHlmaWxsXHJcblx0ICAgIFV0aWxzLmFzc2lnbiA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBhcmdzID0gW107XHJcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG5cdCAgICAgICAgICAgIGFyZ3NbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgdGFyZ2V0ID0gYXJnc1swXTtcclxuXHQgICAgICAgICd1c2Ugc3RyaWN0JztcclxuXHQgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBvdXRwdXQgPSBPYmplY3QodGFyZ2V0KTtcclxuXHQgICAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0ICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XHJcblx0ICAgICAgICAgICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkICYmIHNvdXJjZSAhPT0gbnVsbCkge1xyXG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBuZXh0S2V5IGluIHNvdXJjZSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShuZXh0S2V5KSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFtuZXh0S2V5XSA9IHNvdXJjZVtuZXh0S2V5XTtcclxuXHQgICAgICAgICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBvdXRwdXQ7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBVdGlscztcclxuXHR9KCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBVdGlscztcclxuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XHJcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG5cdH07XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciBSZXBvcnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG5cdCAgICBfX2V4dGVuZHMoUmVwb3J0LCBfc3VwZXIpO1xyXG5cdCAgICBmdW5jdGlvbiBSZXBvcnQoKSB7XHJcblx0ICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHQgICAgfVxyXG5cdCAgICBSZXBvcnQucHJvdG90eXBlLmdldEVtYmVkVXJsID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gX3N1cGVyLnByb3RvdHlwZS5nZXRFbWJlZFVybC5jYWxsKHRoaXMpO1xyXG5cdCAgICAgICAgLy8gVE9ETzogTmVlZCBzYWZlIHdheSB0byBhZGQgdXJsIHBhcmFtZXRlcnMuXHJcblx0ICAgICAgICAvLyBXZSBhcmUgYXNzdW1pbmcgZW1iZWRVcmxzIHVzZSBxdWVyeSBwYXJhbWV0ZXJzIHRvIHN1cHBseSBpZCBvZiB2aXN1YWxcclxuXHQgICAgICAgIC8vIHNvIG11c3QgcHJlZml4IHdpdGggJyYnLlxyXG5cdCAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZmlsdGVyUGFuZUVuYWJsZWQpIHtcclxuXHQgICAgICAgICAgICBlbWJlZFVybCArPSBcIiZmaWx0ZXJQYW5lRW5hYmxlZD1mYWxzZVwiO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGVtYmVkVXJsO1xyXG5cdCAgICB9O1xyXG5cdCAgICBSZXBvcnQucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAob3B0aW9ucywgcmVxdWlyZUlkKSB7XHJcblx0ICAgICAgICBpZiAocmVxdWlyZUlkID09PSB2b2lkIDApIHsgcmVxdWlyZUlkID0gZmFsc2U7IH1cclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgJiYgdHlwZW9mIG9wdGlvbnMuaWQgIT09ICdzdHJpbmcnKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWQgbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiBsb2FkaW5nIHJlcG9ydHMgb24gZXhpc3RpbmcgZWxlbWVudHMuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XHJcblx0ICAgICAgICAgICAgYWN0aW9uOiAnbG9hZFJlcG9ydCcsXHJcblx0ICAgICAgICAgICAgcmVwb3J0SWQ6IG9wdGlvbnMuaWQsXHJcblx0ICAgICAgICAgICAgYWNjZXNzVG9rZW46IG51bGxcclxuXHQgICAgICAgIH07XHJcblx0ICAgICAgICBfc3VwZXIucHJvdG90eXBlLmxvYWQuY2FsbCh0aGlzLCBvcHRpb25zLCByZXF1aXJlSWQsIG1lc3NhZ2UpO1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gUmVwb3J0O1xyXG5cdH0oZW1iZWRfMS5kZWZhdWx0KSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFJlcG9ydDtcclxuXG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XHJcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG5cdH07XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciBUaWxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuXHQgICAgX19leHRlbmRzKFRpbGUsIF9zdXBlcik7XHJcblx0ICAgIGZ1bmN0aW9uIFRpbGUoKSB7XHJcblx0ICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHQgICAgfVxyXG5cdCAgICBUaWxlLnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IF9zdXBlci5wcm90b3R5cGUuZ2V0RW1iZWRVcmwuY2FsbCh0aGlzKTtcclxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcclxuXHQgICAgfTtcclxuXHQgICAgVGlsZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChvcHRpb25zLCByZXF1aXJlSWQpIHtcclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgPT09IHZvaWQgMCkgeyByZXF1aXJlSWQgPSBmYWxzZTsgfVxyXG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCAmJiB0eXBlb2Ygb3B0aW9ucy5pZCAhPT0gJ3N0cmluZycpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpZCBtdXN0IGJlIHNwZWNpZmllZCB3aGVuIGxvYWRpbmcgcmVwb3J0cyBvbiBleGlzdGluZyBlbGVtZW50cy5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgbWVzc2FnZSA9IHtcclxuXHQgICAgICAgICAgICBhY3Rpb246ICdsb2FkVGlsZScsXHJcblx0ICAgICAgICAgICAgdGlsZUlkOiBvcHRpb25zLmlkLFxyXG5cdCAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBudWxsXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkLmNhbGwodGhpcywgb3B0aW9ucywgcmVxdWlyZUlkLCBtZXNzYWdlKTtcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIFRpbGU7XHJcblx0fShlbWJlZF8xLmRlZmF1bHQpKTtcclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcblx0ZXhwb3J0cy5kZWZhdWx0ID0gVGlsZTtcclxuXG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cG93ZXJiaS5qcy5tYXAiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
