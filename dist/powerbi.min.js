!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o=n(1);window.Powerbi=o["default"],window.powerbi=new o["default"]},function(e,t,n){"use strict";var o=n(2),r=n(5),i=n(4),s=function(){function e(t){var n=this;void 0===t&&(t={}),this.get=this.embed,this.embeds=[],window.addEventListener("message",this.onReceiveMessage.bind(this),!1),this.config=i["default"].assign({},e.defaultConfig,t),this.config.autoEmbedOnContentLoaded&&window.addEventListener("DOMContentLoaded",function(e){return n.init(document.body)},!1)}return e.prototype.init=function(e){var t=this;e=e&&e instanceof HTMLElement?e:document.body;var n=Array.prototype.slice.call(e.querySelectorAll("[powerbi-embed]"));n.forEach(function(e){return t.embed(e,{getGlobalAccessToken:function(){return t.accessToken}})})},e.prototype.embed=function(t,n){var o=this;void 0===n&&(n={});var r;if(t.powerBiEmbed&&!n.overwrite)return r=t.powerBiEmbed;t.powerBiEmbed&&n.overwrite&&this.remove(t.powerBiEmbed);var s=i["default"].find(function(e){return n.type===e.attribute||null!==t.getAttribute(e.attribute)},e.components);if(!s)throw new Error("Attempted to embed using config "+n+" on element "+t.outerHTML+", but could not determine what type of component to embed. You must specify a type in the configuration or as an attribute such as 'powerbi-report'.");return n.getGlobalAccessToken=function(){return o.accessToken},r=new s(t,n),t.powerBiEmbed=r,this.embeds.push(r),r},e.prototype.remove=function(e){i["default"].remove(function(t){return t===e},this.embeds)},e.prototype.onReceiveMessage=function(t){if(t)try{var n=JSON.parse(t.data);this.embeds.some(function(o){return t.source===o.iframe.contentWindow?(i["default"].raiseCustomEvent(o.element,e.eventMap[n.event],n),!0):!1})}catch(o){if("function"!=typeof this.config.onError)throw o;this.config.onError.call(window,o)}},e.components=[r["default"],o["default"]],e.eventMap={tileClicked:"tile-click",tileLoaded:"tile-load",reportPageLoaded:"report-load"},e.defaultConfig={autoEmbedOnContentLoaded:!1,onError:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return console.log(e[0],e.slice(1))}},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=s},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),i=function(e){function t(t,n){n.loadAction="loadReport",e.call(this,t,n)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);if(!t){var n=this.options.id;if(n||(n=this.element.getAttribute("powerbi-report")),!n)throw new Error("Embed url cannot be constructed. 'powerbi-embed' attribute was not specified and the fallback to 'powerbi-report' were not specified either.");t="https://embedded.powerbi.com/appTokenReportEmbed?reportId="+n}return this.options.filterPaneEnabled||(t+="&filterPaneEnabled=false"),t},t.attribute="powerbi-report",t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t,n){"use strict";var o=n(4),r=function(){function e(t,n){this.element=t,this.options=o["default"].assign({},e.defaultOptions,n);var r=this.getEmbedUrl(),i='<iframe style="width:100%;height:100%;" src="'+r+'" scrolling="no" allowfullscreen="true"></iframe>';this.element.innerHTML=i,this.iframe=this.element.childNodes[0],this.iframe.addEventListener("load",this.load.bind(this),!1)}return e.prototype.load=function(){var e=window.getComputedStyle(this.element),t=this.getAccessToken(),n={message:{action:this.options.loadAction,accessToken:t,width:e.width,height:e.height}};o["default"].raiseCustomEvent(this.element,"embed-init",n),this.iframe.contentWindow.postMessage(JSON.stringify(n.message),"*")},e.prototype.getAccessToken=function(){var e=this.options.accessToken||this.element.getAttribute("powerbi-access-token")||this.options.getGlobalAccessToken();if(!e)throw new Error("No access token was found for element. You must specify an access token directly on the element using attribute 'powerbi-access-token' or specify a global token at: powerbi.accessToken.");return e},e.prototype.getEmbedUrl=function(){var e=this.options.embedUrl||this.element.getAttribute("powerbi-embed");return e},e.prototype.fullscreen=function(){var e=this.iframe.requestFullscreen||this.iframe.msRequestFullscreen||this.iframe.mozRequestFullScreen||this.iframe.webkitRequestFullscreen;e.call(this.iframe)},e.prototype.exitFullscreen=function(){if(this.isFullscreen(this.iframe)){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;e.call(document)}},e.prototype.isFullscreen=function(e){var t=["fullscreenElement","webkitFullscreenElement","mozFullscreenScreenElement","msFullscreenElement"];return t.some(function(t){return document[t]===e})},e.defaultOptions={filterPaneEnabled:!0},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t){"use strict";var n=function(){function e(){}return e.raiseCustomEvent=function(e,t,n){var o;if("function"==typeof window.CustomEvent?o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(o),!o.defaultPrevented&&o.returnValue){var r="on"+t.replace("-",""),i=e.getAttribute(r);i&&eval.call(e,i)}},e.findIndex=function(e,t){if(!Array.isArray(t))throw new Error("You attempted to call find with second that was not an array. You passed: "+t);var n;return t.some(function(t,o){return e(t)?(n=o,!0):void 0}),n},e.find=function(t,n){var o=e.findIndex(t,n);return n[o]},e.remove=function(t,n){var o=e.findIndex(t,n);n.splice(o,1)},e.assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e[0];if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}return o},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(3),i=function(e){function t(t,n){n.loadAction="loadTile",e.call(this,t,n)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);if(!t){var n=this.element.getAttribute("powerbi-dashboard"),o=this.element.getAttribute("powerbi-tile");if(!n||!o)throw new Error("Embed url cannot be constructed. 'powerbi-embed' attribute was not specified and the fallback to 'powerbi-dashboard' and 'powerbi-tile' were not specified either.");t="https://app.powerbi.com/embed?dashboardId="+n+"&tileId="+o}return t},t.attribute="powerbi-tile",t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvd2VyYmkuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiY29yZV8xIiwid2luZG93IiwiUG93ZXJiaSIsInBvd2VyYmkiLCJyZXBvcnRfMSIsInRpbGVfMSIsInV0aWxfMSIsIlBvd2VyQmkiLCJjb25maWciLCJfdGhpcyIsInRoaXMiLCJnZXQiLCJlbWJlZCIsImVtYmVkcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiYmluZCIsImFzc2lnbiIsImRlZmF1bHRDb25maWciLCJhdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQiLCJldmVudCIsImluaXQiLCJkb2N1bWVudCIsImJvZHkiLCJwcm90b3R5cGUiLCJjb250YWluZXIiLCJIVE1MRWxlbWVudCIsImVsZW1lbnRzIiwiQXJyYXkiLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWxlbWVudCIsImdldEdsb2JhbEFjY2Vzc1Rva2VuIiwiYWNjZXNzVG9rZW4iLCJpbnN0YW5jZSIsInBvd2VyQmlFbWJlZCIsIm92ZXJ3cml0ZSIsInJlbW92ZSIsIkNvbXBvbmVudCIsImZpbmQiLCJjb21wb25lbnQiLCJ0eXBlIiwiYXR0cmlidXRlIiwiZ2V0QXR0cmlidXRlIiwiY29tcG9uZW50cyIsIkVycm9yIiwib3V0ZXJIVE1MIiwicHVzaCIsIngiLCJtZXNzYWdlRGF0YSIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCJzb21lIiwic291cmNlIiwiaWZyYW1lIiwiY29udGVudFdpbmRvdyIsInJhaXNlQ3VzdG9tRXZlbnQiLCJldmVudE1hcCIsImUiLCJvbkVycm9yIiwidGlsZUNsaWNrZWQiLCJ0aWxlTG9hZGVkIiwicmVwb3J0UGFnZUxvYWRlZCIsImFyZ3MiLCJfaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX19leHRlbmRzIiwiZCIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiaGFzT3duUHJvcGVydHkiLCJjcmVhdGUiLCJlbWJlZF8xIiwiUmVwb3J0IiwiX3N1cGVyIiwib3B0aW9ucyIsImxvYWRBY3Rpb24iLCJnZXRFbWJlZFVybCIsImVtYmVkVXJsIiwicmVwb3J0SWQiLCJmaWx0ZXJQYW5lRW5hYmxlZCIsIkVtYmVkIiwiZGVmYXVsdE9wdGlvbnMiLCJpZnJhbWVIdG1sIiwiaW5uZXJIVE1MIiwiY2hpbGROb2RlcyIsImxvYWQiLCJjb21wdXRlZFN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldEFjY2Vzc1Rva2VuIiwiaW5pdEV2ZW50QXJncyIsIm1lc3NhZ2UiLCJhY3Rpb24iLCJ3aWR0aCIsImhlaWdodCIsInBvc3RNZXNzYWdlIiwic3RyaW5naWZ5IiwiZnVsbHNjcmVlbiIsInJlcXVlc3RGdWxsU2NyZWVuIiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJtc1JlcXVlc3RGdWxsc2NyZWVuIiwibW96UmVxdWVzdEZ1bGxTY3JlZW4iLCJ3ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwiaXNGdWxsc2NyZWVuIiwibW96Q2FuY2VsRnVsbFNjcmVlbiIsIndlYmtpdEV4aXRGdWxsc2NyZWVuIiwibXNFeGl0RnVsbHNjcmVlbiIsIm9wdGlvbiIsIlV0aWxzIiwiZXZlbnROYW1lIiwiZXZlbnREYXRhIiwiY3VzdG9tRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImJ1YmJsZXMiLCJjYW5jZWxhYmxlIiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwiZGVmYXVsdFByZXZlbnRlZCIsInJldHVyblZhbHVlIiwiaW5saW5lRXZlbnRBdHRyIiwicmVwbGFjZSIsImlubGluZVNjcmlwdCIsImV2YWwiLCJmaW5kSW5kZXgiLCJwcmVkaWNhdGUiLCJ4cyIsImlzQXJyYXkiLCJpbmRleCIsImkiLCJzcGxpY2UiLCJ0YXJnZXQiLCJ1bmRlZmluZWQiLCJUeXBlRXJyb3IiLCJvdXRwdXQiLCJuZXh0S2V5IiwiVGlsZSIsImRhc2hib2FyZElkIiwidGlsZUlkIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQUtULFFBQVNDLEdBQW9CQyxHQUc1QixHQUFHQyxFQUFpQkQsR0FDbkIsTUFBT0MsR0FBaUJELEdBQVVFLE9BR25DLElBQUlDLEdBQVNGLEVBQWlCRCxJQUM3QkUsV0FDQUUsR0FBSUosRUFDSkssUUFBUSxFQVVULE9BTkFQLEdBQVFFLEdBQVVNLEtBQUtILEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNILEdBRy9ESSxFQUFPRSxRQUFTLEVBR1RGLEVBQU9ELFFBdkJmLEdBQUlELEtBcUNKLE9BVEFGLEdBQW9CUSxFQUFJVCxFQUd4QkMsRUFBb0JTLEVBQUlQLEVBR3hCRixFQUFvQlUsRUFBSSxHQUdqQlYsRUFBb0IsS0FLL0IsU0FBU0ksRUFBUUQsRUFBU0gsR0FFL0IsWUFDQSxJQUFJVyxHQUFTWCxFQUFvQixFQU1qQ1ksUUFBT0MsUUFBVUYsRUFBQUEsV0FDakJDLE9BQU9FLFFBQVUsR0FBSUgsR0FBQUEsWUFLaEIsU0FBU1AsRUFBUUQsRUFBU0gsR0FFL0IsWUFDQSxJQUFJZSxHQUFXZixFQUFvQixHQUMvQmdCLEVBQVNoQixFQUFvQixHQUM3QmlCLEVBQVNqQixFQUFvQixHQUM3QmtCLEVBQVcsV0FDWCxRQUFTQSxHQUFRQyxHQUNiLEdBQUlDLEdBQVFDLElBQ0csVUFBWEYsSUFBcUJBLE1BS3pCRSxLQUFLQyxJQUFNRCxLQUFLRSxNQUNoQkYsS0FBS0csVUFDTFosT0FBT2EsaUJBQWlCLFVBQVdKLEtBQUtLLGlCQUFpQkMsS0FBS04sT0FBTyxHQUVyRUEsS0FBS0YsT0FBU0YsRUFBQUEsV0FBZVcsVUFBV1YsRUFBUVcsY0FBZVYsR0FDM0RFLEtBQUtGLE9BQU9XLDBCQUNabEIsT0FBT2EsaUJBQWlCLG1CQUFvQixT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QixNQW5CQVYsR0FBVXlFLEVBQU1oRSxHQU1oQmdFLEVBQUszSCxVQUFVOEQsWUFBYyxXQUN6QixHQUFJQyxHQUFXSixFQUFPM0QsVUFBVThELFlBQVkxRixLQUFLYyxLQUNqRCxLQUFLNkUsRUFBVSxDQUNYLEdBQUk2RCxHQUFjMUksS0FBS3NCLFFBQVFZLGFBQWEscUJBQ3hDeUcsRUFBUzNJLEtBQUtzQixRQUFRWSxhQUFhLGVBQ3ZDLEtBQU13RyxJQUFlQyxFQUNqQixLQUFNLElBQUl2RyxPQUFNLHFLQUVwQnlDLEdBQVcsNkNBQStDNkQsRUFBYyxXQUFhQyxFQUV6RixNQUFPOUQsSUFFWDRELEVBQUt4RyxVQUFZLGVBQ1Z3RyxHQUNUbEUsRUFBQUEsV0FDRlYsUUFBT0MsZUFBZWhGLEVBQVMsY0FBZ0JpRixPQUFPLElBQ3REakYsRUFBQUEsV0FBa0IySiIsImZpbGUiOiJwb3dlcmJpLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcclxuXHQvKipcclxuXHQgKiBNYWtlIFBvd2VyQmkgYXZhaWxhYmxlIG9uIGdsb2JhbCBvYmplY3QgZm9yIHVzZSBpbiBhcHBzIHdpdGhvdXQgbW9kdWxlIGxvYWRpbmcgc3VwcG9ydC5cclxuXHQgKiBTYXZlIGNsYXNzIHRvIGFsbG93IGNyZWF0aW5nIGFuIGluc3RhbmNlIG9mIHRoZSBzZXJ2aWNlLlxyXG5cdCAqIENyZWF0ZSBpbnN0YW5jZSBvZiBjbGFzcyB3aXRoIGRlZmF1bHQgY29uZmlnIGZvciBub3JtYWwgdXNhZ2UuXHJcblx0ICovXHJcblx0d2luZG93LlBvd2VyYmkgPSBjb3JlXzEuZGVmYXVsdDtcclxuXHR3aW5kb3cucG93ZXJiaSA9IG5ldyBjb3JlXzEuZGVmYXVsdCgpO1xyXG5cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciByZXBvcnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XHJcblx0dmFyIHRpbGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XHJcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XHJcblx0dmFyIFBvd2VyQmkgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBQb3dlckJpKGNvbmZpZykge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIGlmIChjb25maWcgPT09IHZvaWQgMCkgeyBjb25maWcgPSB7fTsgfVxyXG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBEZXByZWNhdGVkIGFsaWFzIGZvciBlbWJlZC5cclxuXHQgICAgICAgICAqIFRoaXMgcGVyZm9ybWVkIHRoZSBzYW1lIGZ1bmN0aW9uIGFzIGVtYmVkLiBFbWJlZCBpcyBtb3JlIHNlbWFudGljIHRvIHRoZSBvcGVyYXRpb24gcGVyZm9ybWVkIHNvIHdlIGNvbnNsaWRhdGVkIHRvIGEgc2luZ2xlIG1ldGhvZC5cclxuXHQgICAgICAgICAqL1xyXG5cdCAgICAgICAgdGhpcy5nZXQgPSB0aGlzLmVtYmVkO1xyXG5cdCAgICAgICAgdGhpcy5lbWJlZHMgPSBbXTtcclxuXHQgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vblJlY2VpdmVNZXNzYWdlLmJpbmQodGhpcyksIGZhbHNlKTtcclxuXHQgICAgICAgIC8vIFRPRE86IENoYW5nZSB3aGVuIE9iamVjdC5hc3NpZ24gaXMgYXZhaWxhYmxlLlxyXG5cdCAgICAgICAgdGhpcy5jb25maWcgPSB1dGlsXzEuZGVmYXVsdC5hc3NpZ24oe30sIFBvd2VyQmkuZGVmYXVsdENvbmZpZywgY29uZmlnKTtcclxuXHQgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQpIHtcclxuXHQgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaW5pdChkb2N1bWVudC5ib2R5KTsgfSwgZmFsc2UpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBIYW5kbGVyIGZvciBET01Db250ZW50TG9hZGVkIHdoaWNoIHNlYXJjaGVzIERPTSBmb3IgZWxlbWVudHMgaGF2aW5nICdwb3dlcmJpLWVtYmVkJyBhdHRyaWJ1dGVcclxuXHQgICAgICogYW5kIGF1dG9tYXRpY2FsbHkgYXR0ZW1wdHMgdG8gZW1iZWQgYSBwb3dlcmJpIGNvbXBvbmVudCBiYXNlZCBvbiBpbmZvcm1hdGlvbiBmcm9tIHRoZSBhdHRyaWJ1dGVzLlxyXG5cdCAgICAgKiBPbmx5IHJ1bnMgaWYgYGNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWRgIGlzIHRydWUgd2hlbiB0aGUgc2VydmljZSBpcyBjcmVhdGVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBjb250YWluZXIgPSAoY29udGFpbmVyICYmIGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSA/IGNvbnRhaW5lciA6IGRvY3VtZW50LmJvZHk7XHJcblx0ICAgICAgICB2YXIgZWxlbWVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnW3Bvd2VyYmktZW1iZWRdJykpO1xyXG5cdCAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gX3RoaXMuZW1iZWQoZWxlbWVudCwgeyBnZXRHbG9iYWxBY2Nlc3NUb2tlbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYWNjZXNzVG9rZW47IH0gfSk7IH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2l2ZW4gYW4gaHRtbCBlbGVtZW50IGVtYmVkIGNvbXBvbmVudCBiYXNlZCBvbiBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKiBJZiBjb21wb25lbnQgaGFzIGFscmVhZHkgYmVlbiBjcmVhdGVkIGFuZCBhdHRhY2hlZCB0byBlbGVlbW50IHNpbXBseSByZXR1cm4gaXQgdG8gcHJldmVudCBjcmVhdGluZyBkdXBsaWNhdGUgY29tcG9uZW50cyBmb3Igc2FtZSBlbGVtZW50LlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZW1iZWQgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29uZmlnKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgaWYgKGNvbmZpZyA9PT0gdm9pZCAwKSB7IGNvbmZpZyA9IHt9OyB9XHJcblx0ICAgICAgICB2YXIgaW5zdGFuY2U7XHJcblx0ICAgICAgICBpZiAoZWxlbWVudC5wb3dlckJpRW1iZWQgJiYgIWNvbmZpZy5vdmVyd3JpdGUpIHtcclxuXHQgICAgICAgICAgICBpbnN0YW5jZSA9IGVsZW1lbnQucG93ZXJCaUVtYmVkO1xyXG5cdCAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIC8qKiBJZiBjb21wb25lbnQgaXMgYWxyZWFkeSByZWdpc3RlcmVkIG9uIHRoaXMgZWxlbWVudCwgYnV0IHdlIGFyZSBzdXBwb3NlZCB0byBvdmVyd3JpdGUsIHJlbW92ZSBleGlzdGluZyBjb21wb25lbnQgZnJvbSByZWdpc3RyeSAqL1xyXG5cdCAgICAgICAgaWYgKGVsZW1lbnQucG93ZXJCaUVtYmVkICYmIGNvbmZpZy5vdmVyd3JpdGUpIHtcclxuXHQgICAgICAgICAgICB0aGlzLnJlbW92ZShlbGVtZW50LnBvd2VyQmlFbWJlZCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgQ29tcG9uZW50ID0gdXRpbF8xLmRlZmF1bHQuZmluZChmdW5jdGlvbiAoY29tcG9uZW50KSB7IHJldHVybiBjb25maWcudHlwZSA9PT0gY29tcG9uZW50LmF0dHJpYnV0ZSB8fCBlbGVtZW50LmdldEF0dHJpYnV0ZShjb21wb25lbnQuYXR0cmlidXRlKSAhPT0gbnVsbDsgfSwgUG93ZXJCaS5jb21wb25lbnRzKTtcclxuXHQgICAgICAgIGlmICghQ29tcG9uZW50KSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGVtYmVkIHVzaW5nIGNvbmZpZyBcIiArIGNvbmZpZyArIFwiIG9uIGVsZW1lbnQgXCIgKyBlbGVtZW50Lm91dGVySFRNTCArIFwiLCBidXQgY291bGQgbm90IGRldGVybWluZSB3aGF0IHR5cGUgb2YgY29tcG9uZW50IHRvIGVtYmVkLiBZb3UgbXVzdCBzcGVjaWZ5IGEgdHlwZSBpbiB0aGUgY29uZmlndXJhdGlvbiBvciBhcyBhbiBhdHRyaWJ1dGUgc3VjaCBhcyAncG93ZXJiaS1yZXBvcnQnLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIC8vIFRPRE86IENvbnNpZGVyIHJlbW92aW5nIGluIGZhdm9yIG9mIHBhc3NpbmcgcmVmZXJlbmNlIHRvIGB0aGlzYCBpbiBjb25zdHJ1Y3RvclxyXG5cdCAgICAgICAgLy8gVGhlIGdldEdsb2JhbEFjY2Vzc1Rva2VuIGZ1bmN0aW9uIGlzIG9ubHkgaGVyZSBzbyB0aGF0IHRoZSBjb21wb25lbnRzIChUaWxlIHwgUmVwb3J0KSBjYW4gZ2V0IHRoZSBnbG9iYWwgYWNjZXNzIHRva2VuIHdpdGhvdXQgbmVlZGluZyByZWZlcmVuY2VcclxuXHQgICAgICAgIC8vIHRvIHRoZSBzZXJ2aWNlIHRoYXQgdGhleSBhcmUgcmVnaXN0ZXJlZCB3aXRoaW4gYmVjYXVlcyBpdCBjcmVhdGVzIGNpcmN1bGFyIGRlcGVuZGVuY2llc1xyXG5cdCAgICAgICAgY29uZmlnLmdldEdsb2JhbEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYWNjZXNzVG9rZW47IH07XHJcblx0ICAgICAgICBpbnN0YW5jZSA9IG5ldyBDb21wb25lbnQoZWxlbWVudCwgY29uZmlnKTtcclxuXHQgICAgICAgIGVsZW1lbnQucG93ZXJCaUVtYmVkID0gaW5zdGFuY2U7XHJcblx0ICAgICAgICB0aGlzLmVtYmVkcy5wdXNoKGluc3RhbmNlKTtcclxuXHQgICAgICAgIHJldHVybiBpbnN0YW5jZTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJlbW92ZSBjb21wb25lbnQgZnJvbSB0aGUgbGlzdCBvZiBlbWJlZGRlZCBjb21wb25lbnRzLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xyXG5cdCAgICAgICAgdXRpbF8xLmRlZmF1bHQucmVtb3ZlKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4ID09PSBjb21wb25lbnQ7IH0sIHRoaXMuZW1iZWRzKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIHdpbmRvdyBtZXNzYWdlIGV2ZW50LlxyXG5cdCAgICAgKiBQYXJzZXMgZXZlbnQgZGF0YSBhcyBqc29uIGFuZCBpZiBpdCBjYW1lIGZyb20gYW4gaWZyYW1lIHRoYXQgbWF0Y2hlcyBvbmUgZnJvbSBhbiBleGlzdGluZyBlbWJlZGVkIGNvbXBvbmVudCByZS1kaXNwYXRjaGVzIHRoZSBldmVudCBvbiB0aGUgaWZyYW1lJ3MgcGFyZW50IGVsZW1lbnRcclxuXHQgICAgICogdG8gc2ltdWxhdGUgdGhlIGV2ZW50IGJ1YmJsaW5nIHRocm91Z2ggdGhlIHR3byBzZXBhcmF0ZSB3aW5kb3dzIC8gRE9Ncy5cclxuXHQgICAgICpcclxuXHQgICAgICogSWYgYW4gZXJyb3Igb2NjdXJzIHdoZW4gcGFyc2luZyBldmVudC5kYXRhIGNhbGwgZXJyb3IgaGFuZGxlciBwcm92aWRlZCBkdXJpbmcgY29uZmlndXJhdGlvbi5cclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLm9uUmVjZWl2ZU1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHQgICAgICAgIGlmICghZXZlbnQpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB0cnkge1xyXG5cdCAgICAgICAgICAgIHZhciBtZXNzYWdlRGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcblx0ICAgICAgICAgICAgdGhpcy5lbWJlZHMuc29tZShmdW5jdGlvbiAoZW1iZWQpIHtcclxuXHQgICAgICAgICAgICAgICAgLy8gT25seSByYWlzZSB0aGUgZXZlbnQgb24gdGhlIGVtYmVkIHRoYXQgbWF0Y2hlcyB0aGUgcG9zdCBtZXNzYWdlIG9yaWdpblxyXG5cdCAgICAgICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBlbWJlZC5pZnJhbWUuY29udGVudFdpbmRvdykge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgdXRpbF8xLmRlZmF1bHQucmFpc2VDdXN0b21FdmVudChlbWJlZC5lbGVtZW50LCBQb3dlckJpLmV2ZW50TWFwW21lc3NhZ2VEYXRhLmV2ZW50XSwgbWVzc2FnZURhdGEpO1xyXG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblx0ICAgICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cdCAgICAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgY2F0Y2ggKGUpIHtcclxuXHQgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY29uZmlnLm9uRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICAgICAgdGhpcy5jb25maWcub25FcnJvci5jYWxsKHdpbmRvdywgZSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIExpc3Qgb2YgY29tcG9uZW50cyB0aGlzIHNlcnZpY2UgY2FuIGVtYmVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgLy8gVE9ETzogRmluZCBvdXQgaG93IHRvIHVzZSBpbnRlcmZhY2UgaGVyZSBpbnN0ZWFkIG9mIGNvbmNyZXRlIHR5cGUgc28gd2UgZG9uJ3QgaGF2ZSB0byBcclxuXHQgICAgLy8gdXNlIHVuaW9uIHR5cGVzIHdoaWNoIGFyZSBtYWludGVuYW5jZSBwcm9ibGVtXHJcblx0ICAgIFBvd2VyQmkuY29tcG9uZW50cyA9IFtcclxuXHQgICAgICAgIHRpbGVfMS5kZWZhdWx0LFxyXG5cdCAgICAgICAgcmVwb3J0XzEuZGVmYXVsdFxyXG5cdCAgICBdO1xyXG5cdCAgICAvKipcclxuXHQgICAgICogTWFwcGluZyBvZiBldmVudCBuYW1lcyBmcm9tIGlmcmFtZSBwb3N0TWVzc2FnZSB0byB0aGVpciBuYW1lIHBlcmNpZXZlZCBieSBwYXJlbnQgRE9NLlxyXG5cdCAgICAgKiBFeGFtcGxlOiBVc2VyIGNsaWNrcyBvbiBlbWJlZGVkIHJlcG9ydCB3aGljaCBpcyBpbnNpZGUgaWZyYW1lLiBUaGUgaWZyYW1lIGNvZGUgcmVzZW5kc1xyXG5cdCAgICAgKiBldmVudCBhcyBwb3N0TWVzc2FnZSB3aXRoIHsgZXZlbnQ6ICdyZXBvcnRDbGlja2VkJywgLi4uIH0gYW5kIHRoaXMgbmFtZSBpcyBjb252ZXJ0ZWQgdG8gaHlwaGVuYXRlZFxyXG5cdCAgICAgKiBuYW1lIGFuZCBkaXNwYXRjaGVkIGZyb20gdGhlIHBhcmVudCBlbGVtZW50IG9mIHRoZSBpZnJhbWUgdG8gc2ltdWxhdGUgdGhlIGV2ZW50IGJ1YmJsaW5nIHRocm91Z2ggdHdvXHJcblx0ICAgICAqIGRpZmZlcmVudCB3aW5kb3dzIC8gRE9Nc1xyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5ldmVudE1hcCA9IHtcclxuXHQgICAgICAgICd0aWxlQ2xpY2tlZCc6ICd0aWxlLWNsaWNrJyxcclxuXHQgICAgICAgICd0aWxlTG9hZGVkJzogJ3RpbGUtbG9hZCcsXHJcblx0ICAgICAgICAncmVwb3J0UGFnZUxvYWRlZCc6ICdyZXBvcnQtbG9hZCdcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIERlZmF1bHQgY29uZmlndXJhdGlvbiBmb3Igc2VydmljZS5cclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkuZGVmYXVsdENvbmZpZyA9IHtcclxuXHQgICAgICAgIGF1dG9FbWJlZE9uQ29udGVudExvYWRlZDogZmFsc2UsXHJcblx0ICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuXHQgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG5cdCAgICAgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coYXJnc1swXSwgYXJncy5zbGljZSgxKSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBQb3dlckJpO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFBvd2VyQmk7XHJcblxuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xyXG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcclxuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuXHR9O1xyXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcclxuXHR2YXIgUmVwb3J0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuXHQgICAgX19leHRlbmRzKFJlcG9ydCwgX3N1cGVyKTtcclxuXHQgICAgZnVuY3Rpb24gUmVwb3J0KGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHQgICAgICAgIC8qKiBGb3JjZSBsb2FkQWN0aW9uIG9uIG9wdGlvbnMgdG8gbWF0Y2ggdGhlIHR5cGUgb2YgY29tcG9uZW50LiBUaGlzIGlzIHJlcXVpcmVkIHRvIGJvb3RzdHJhcCBpZnJhbWUuICovXHJcblx0ICAgICAgICBvcHRpb25zLmxvYWRBY3Rpb24gPSAnbG9hZFJlcG9ydCc7XHJcblx0ICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBvcHRpb25zKTtcclxuXHQgICAgfVxyXG5cdCAgICBSZXBvcnQucHJvdG90eXBlLmdldEVtYmVkVXJsID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gX3N1cGVyLnByb3RvdHlwZS5nZXRFbWJlZFVybC5jYWxsKHRoaXMpO1xyXG5cdCAgICAgICAgaWYgKCFlbWJlZFVybCkge1xyXG5cdCAgICAgICAgICAgIHZhciByZXBvcnRJZCA9IHRoaXMub3B0aW9ucy5pZDtcclxuXHQgICAgICAgICAgICBpZiAoIXJlcG9ydElkKSB7XHJcblx0ICAgICAgICAgICAgICAgIHJlcG9ydElkID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgncG93ZXJiaS1yZXBvcnQnKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgaWYgKCFyZXBvcnRJZCkge1xyXG5cdCAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWJlZCB1cmwgY2Fubm90IGJlIGNvbnN0cnVjdGVkLiAncG93ZXJiaS1lbWJlZCcgYXR0cmlidXRlIHdhcyBub3Qgc3BlY2lmaWVkIGFuZCB0aGUgZmFsbGJhY2sgdG8gJ3Bvd2VyYmktcmVwb3J0JyB3ZXJlIG5vdCBzcGVjaWZpZWQgZWl0aGVyLlwiKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZW1iZWRVcmwgPSBcImh0dHBzOi8vZW1iZWRkZWQucG93ZXJiaS5jb20vYXBwVG9rZW5SZXBvcnRFbWJlZD9yZXBvcnRJZD1cIiArIHJlcG9ydElkO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLy8gVE9ETzogTmVlZCBzYWZlIHdheSB0byBhZGQgdXJsIHBhcmFtZXRlcnMuXHJcblx0ICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5maWx0ZXJQYW5lRW5hYmxlZCkge1xyXG5cdCAgICAgICAgICAgIGVtYmVkVXJsICs9IFwiJmZpbHRlclBhbmVFbmFibGVkPWZhbHNlXCI7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gZW1iZWRVcmw7XHJcblx0ICAgIH07XHJcblx0ICAgIC8vIEF0dHJpYnV0ZSB1c2VkIHRvIHNwZWNpZnkgaWQgZm9yIHJlcG9ydCBhbmQgc2ltdWx0YW5lb3VzbHkgdXNlZCB0byBrbm93IHdoaWNoIHR5cGUgb2Ygb2JqZWN0IHRoZSBpZCBpcyBmb3IuXHJcblx0ICAgIFJlcG9ydC5hdHRyaWJ1dGUgPSAncG93ZXJiaS1yZXBvcnQnO1xyXG5cdCAgICByZXR1cm4gUmVwb3J0O1xyXG5cdH0oZW1iZWRfMS5kZWZhdWx0KSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFJlcG9ydDtcclxuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgdXRpbF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcclxuXHR2YXIgRW1iZWQgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBFbWJlZChlbGVtZW50LCBvcHRpb25zKSB7XHJcblx0ICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gT2JqZWN0LmFzc2lnbiBpcyBhdmFpbGFibGUuXHJcblx0ICAgICAgICB0aGlzLm9wdGlvbnMgPSB1dGlsXzEuZGVmYXVsdC5hc3NpZ24oe30sIEVtYmVkLmRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IHRoaXMuZ2V0RW1iZWRVcmwoKTtcclxuXHQgICAgICAgIHZhciBpZnJhbWVIdG1sID0gXCI8aWZyYW1lIHN0eWxlPVxcXCJ3aWR0aDoxMDAlO2hlaWdodDoxMDAlO1xcXCIgc3JjPVxcXCJcIiArIGVtYmVkVXJsICsgXCJcXFwiIHNjcm9sbGluZz1cXFwibm9cXFwiIGFsbG93ZnVsbHNjcmVlbj1cXFwidHJ1ZVxcXCI+PC9pZnJhbWU+XCI7XHJcblx0ICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gaWZyYW1lSHRtbDtcclxuXHQgICAgICAgIHRoaXMuaWZyYW1lID0gdGhpcy5lbGVtZW50LmNoaWxkTm9kZXNbMF07XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZS5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgdGhpcy5sb2FkLmJpbmQodGhpcyksIGZhbHNlKTtcclxuXHQgICAgfVxyXG5cdCAgICAvKipcclxuXHQgICAgICogSGFuZGxlciBmb3Igd2hlbiB0aGUgaWZyYW1lIGhhcyBmaW5pc2hlZCBsb2FkaW5nIHRoZSBwb3dlcmJpIHBsYWNlaG9sZGVyIHBhZ2UuXHJcblx0ICAgICAqIFRoaXMgaXMgdXNlZCB0byBpbmplY3QgY29uZmlndXJhdGlvbiBvcHRpb25zIHN1Y2ggYXMgYWNjZXNzIHRva2VuLCBsb2FkQWN0aW9uLCBldGNcclxuXHQgICAgICogd2hpY2ggYWxsb3cgaWZyYW1lIHRvIGxvYWQgdGhlIGFjdHVhbCByZXBvcnQgd2l0aCBhdXRoZW50aWNhdGlvbi5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpO1xyXG5cdCAgICAgICAgdmFyIGFjY2Vzc1Rva2VuID0gdGhpcy5nZXRBY2Nlc3NUb2tlbigpO1xyXG5cdCAgICAgICAgdmFyIGluaXRFdmVudEFyZ3MgPSB7XHJcblx0ICAgICAgICAgICAgbWVzc2FnZToge1xyXG5cdCAgICAgICAgICAgICAgICBhY3Rpb246IHRoaXMub3B0aW9ucy5sb2FkQWN0aW9uLFxyXG5cdCAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjZXNzVG9rZW4sXHJcblx0ICAgICAgICAgICAgICAgIHdpZHRoOiBjb21wdXRlZFN0eWxlLndpZHRoLFxyXG5cdCAgICAgICAgICAgICAgICBoZWlnaHQ6IGNvbXB1dGVkU3R5bGUuaGVpZ2h0XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LnJhaXNlQ3VzdG9tRXZlbnQodGhpcy5lbGVtZW50LCAnZW1iZWQtaW5pdCcsIGluaXRFdmVudEFyZ3MpO1xyXG5cdCAgICAgICAgdGhpcy5pZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeShpbml0RXZlbnRBcmdzLm1lc3NhZ2UpLCAnKicpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2V0IGFjY2VzcyB0b2tlbiBmcm9tIGZpcnN0IGF2YWlsYWJsZSBsb2NhdGlvbjogb3B0aW9ucywgYXR0cmlidXRlLCBnbG9iYWwuXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZ2V0QWNjZXNzVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgYWNjZXNzVG9rZW4gPSB0aGlzLm9wdGlvbnMuYWNjZXNzVG9rZW4gfHwgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgncG93ZXJiaS1hY2Nlc3MtdG9rZW4nKSB8fCB0aGlzLm9wdGlvbnMuZ2V0R2xvYmFsQWNjZXNzVG9rZW4oKTtcclxuXHQgICAgICAgIGlmICghYWNjZXNzVG9rZW4pIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhY2Nlc3MgdG9rZW4gd2FzIGZvdW5kIGZvciBlbGVtZW50LiBZb3UgbXVzdCBzcGVjaWZ5IGFuIGFjY2VzcyB0b2tlbiBkaXJlY3RseSBvbiB0aGUgZWxlbWVudCB1c2luZyBhdHRyaWJ1dGUgJ3Bvd2VyYmktYWNjZXNzLXRva2VuJyBvciBzcGVjaWZ5IGEgZ2xvYmFsIHRva2VuIGF0OiBwb3dlcmJpLmFjY2Vzc1Rva2VuLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdldCBlbWJlZCB1cmwgZnJvbSBmaXJzdCBhdmFpbGFibGUgbG9jYXRpb246IG9wdGlvbnMsIGF0dHJpYnV0ZS5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IHRoaXMub3B0aW9ucy5lbWJlZFVybCB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdwb3dlcmJpLWVtYmVkJyk7XHJcblx0ICAgICAgICByZXR1cm4gZW1iZWRVcmw7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBSZXF1ZXN0IHRoZSBicm93c2VyIHRvIG1ha2UgdGhlIGNvbXBvbmVudHMgaWZyYW1lIGZ1bGxzY3JlZW4uXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZnVsbHNjcmVlbiA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciByZXF1ZXN0RnVsbFNjcmVlbiA9IHRoaXMuaWZyYW1lLnJlcXVlc3RGdWxsc2NyZWVuIHx8IHRoaXMuaWZyYW1lLm1zUmVxdWVzdEZ1bGxzY3JlZW4gfHwgdGhpcy5pZnJhbWUubW96UmVxdWVzdEZ1bGxTY3JlZW4gfHwgdGhpcy5pZnJhbWUud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW47XHJcblx0ICAgICAgICByZXF1ZXN0RnVsbFNjcmVlbi5jYWxsKHRoaXMuaWZyYW1lKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEV4aXQgZnVsbHNjcmVlbi5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5leGl0RnVsbHNjcmVlbiA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIGlmICghdGhpcy5pc0Z1bGxzY3JlZW4odGhpcy5pZnJhbWUpKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIGV4aXRGdWxsc2NyZWVuID0gZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4gfHwgZG9jdW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlbiB8fCBkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbiB8fCBkb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuO1xyXG5cdCAgICAgICAgZXhpdEZ1bGxzY3JlZW4uY2FsbChkb2N1bWVudCk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBpZnJhbWUgaXMgZnVsbHNjcmVlbixcclxuXHQgICAgICogb3RoZXJ3aXNlIHJldHVybiBmYWxzZVxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmlzRnVsbHNjcmVlbiA9IGZ1bmN0aW9uIChpZnJhbWUpIHtcclxuXHQgICAgICAgIHZhciBvcHRpb25zID0gWydmdWxsc2NyZWVuRWxlbWVudCcsICd3ZWJraXRGdWxsc2NyZWVuRWxlbWVudCcsICdtb3pGdWxsc2NyZWVuU2NyZWVuRWxlbWVudCcsICdtc0Z1bGxzY3JlZW5FbGVtZW50J107XHJcblx0ICAgICAgICByZXR1cm4gb3B0aW9ucy5zb21lKGZ1bmN0aW9uIChvcHRpb24pIHsgcmV0dXJuIGRvY3VtZW50W29wdGlvbl0gPT09IGlmcmFtZTsgfSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBEZWZhdWx0IG9wdGlvbnMgZm9yIGVtYmVkZGFibGUgY29tcG9uZW50LlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQuZGVmYXVsdE9wdGlvbnMgPSB7XHJcblx0ICAgICAgICBmaWx0ZXJQYW5lRW5hYmxlZDogdHJ1ZVxyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gRW1iZWQ7XHJcblx0fSgpKTtcclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcblx0ZXhwb3J0cy5kZWZhdWx0ID0gRW1iZWQ7XHJcblxuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIFV0aWxzID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gVXRpbHMoKSB7XHJcblx0ICAgIH1cclxuXHQgICAgVXRpbHMucmFpc2VDdXN0b21FdmVudCA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudE5hbWUsIGV2ZW50RGF0YSkge1xyXG5cdCAgICAgICAgdmFyIGN1c3RvbUV2ZW50O1xyXG5cdCAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuQ3VzdG9tRXZlbnQgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudE5hbWUsIHtcclxuXHQgICAgICAgICAgICAgICAgZGV0YWlsOiBldmVudERhdGEsXHJcblx0ICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXHJcblx0ICAgICAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWVcclxuXHQgICAgICAgICAgICB9KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIGN1c3RvbUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XHJcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgdHJ1ZSwgZXZlbnREYXRhKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XHJcblx0ICAgICAgICBpZiAoY3VzdG9tRXZlbnQuZGVmYXVsdFByZXZlbnRlZCB8fCAhY3VzdG9tRXZlbnQucmV0dXJuVmFsdWUpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgaW5saW5lRXZlbnRBdHRyID0gJ29uJyArIGV2ZW50TmFtZS5yZXBsYWNlKCctJywgJycpO1xyXG5cdCAgICAgICAgdmFyIGlubGluZVNjcmlwdCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGlubGluZUV2ZW50QXR0cik7XHJcblx0ICAgICAgICBpZiAoaW5saW5lU2NyaXB0KSB7XHJcblx0ICAgICAgICAgICAgZXZhbC5jYWxsKGVsZW1lbnQsIGlubGluZVNjcmlwdCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLmZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHhzKSB7XHJcblx0ICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoeHMpKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBjYWxsIGZpbmQgd2l0aCBzZWNvbmQgdGhhdCB3YXMgbm90IGFuIGFycmF5LiBZb3UgcGFzc2VkOiBcIiArIHhzKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBpbmRleDtcclxuXHQgICAgICAgIHhzLnNvbWUoZnVuY3Rpb24gKHgsIGkpIHtcclxuXHQgICAgICAgICAgICBpZiAocHJlZGljYXRlKHgpKSB7XHJcblx0ICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfSk7XHJcblx0ICAgICAgICByZXR1cm4gaW5kZXg7XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLmZpbmQgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB4cykge1xyXG5cdCAgICAgICAgdmFyIGluZGV4ID0gVXRpbHMuZmluZEluZGV4KHByZWRpY2F0ZSwgeHMpO1xyXG5cdCAgICAgICAgcmV0dXJuIHhzW2luZGV4XTtcclxuXHQgICAgfTtcclxuXHQgICAgVXRpbHMucmVtb3ZlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIHZhciBpbmRleCA9IFV0aWxzLmZpbmRJbmRleChwcmVkaWNhdGUsIHhzKTtcclxuXHQgICAgICAgIHhzLnNwbGljZShpbmRleCwgMSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8vIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2Fzc2lnblxyXG5cdCAgICAvLyBUT0RPOiByZXBsYWNlIGluIGZhdm9yIG9mIHVzaW5nIHBvbHlmaWxsXHJcblx0ICAgIFV0aWxzLmFzc2lnbiA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBhcmdzID0gW107XHJcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG5cdCAgICAgICAgICAgIGFyZ3NbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgdGFyZ2V0ID0gYXJnc1swXTtcclxuXHQgICAgICAgICd1c2Ugc3RyaWN0JztcclxuXHQgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBvdXRwdXQgPSBPYmplY3QodGFyZ2V0KTtcclxuXHQgICAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0ICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XHJcblx0ICAgICAgICAgICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkICYmIHNvdXJjZSAhPT0gbnVsbCkge1xyXG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBuZXh0S2V5IGluIHNvdXJjZSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShuZXh0S2V5KSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFtuZXh0S2V5XSA9IHNvdXJjZVtuZXh0S2V5XTtcclxuXHQgICAgICAgICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBvdXRwdXQ7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBVdGlscztcclxuXHR9KCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBVdGlscztcclxuXG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XHJcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG5cdH07XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xyXG5cdHZhciBUaWxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuXHQgICAgX19leHRlbmRzKFRpbGUsIF9zdXBlcik7XHJcblx0ICAgIGZ1bmN0aW9uIFRpbGUoZWxlbWVudCwgb3B0aW9ucykge1xyXG5cdCAgICAgICAgLyoqIEZvcmNlIGxvYWRBY3Rpb24gb24gb3B0aW9ucyB0byBtYXRjaCB0aGUgdHlwZSBvZiBjb21wb25lbnQuIFRoaXMgaXMgcmVxdWlyZWQgdG8gYm9vdHN0cmFwIGlmcmFtZS4gKi9cclxuXHQgICAgICAgIG9wdGlvbnMubG9hZEFjdGlvbiA9ICdsb2FkVGlsZSc7XHJcblx0ICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBvcHRpb25zKTtcclxuXHQgICAgfVxyXG5cdCAgICBUaWxlLnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IF9zdXBlci5wcm90b3R5cGUuZ2V0RW1iZWRVcmwuY2FsbCh0aGlzKTtcclxuXHQgICAgICAgIGlmICghZW1iZWRVcmwpIHtcclxuXHQgICAgICAgICAgICB2YXIgZGFzaGJvYXJkSWQgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdwb3dlcmJpLWRhc2hib2FyZCcpO1xyXG5cdCAgICAgICAgICAgIHZhciB0aWxlSWQgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdwb3dlcmJpLXRpbGUnKTtcclxuXHQgICAgICAgICAgICBpZiAoIShkYXNoYm9hcmRJZCAmJiB0aWxlSWQpKSB7XHJcblx0ICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVtYmVkIHVybCBjYW5ub3QgYmUgY29uc3RydWN0ZWQuICdwb3dlcmJpLWVtYmVkJyBhdHRyaWJ1dGUgd2FzIG5vdCBzcGVjaWZpZWQgYW5kIHRoZSBmYWxsYmFjayB0byAncG93ZXJiaS1kYXNoYm9hcmQnIGFuZCAncG93ZXJiaS10aWxlJyB3ZXJlIG5vdCBzcGVjaWZpZWQgZWl0aGVyLlwiKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZW1iZWRVcmwgPSBcImh0dHBzOi8vYXBwLnBvd2VyYmkuY29tL2VtYmVkP2Rhc2hib2FyZElkPVwiICsgZGFzaGJvYXJkSWQgKyBcIiZ0aWxlSWQ9XCIgKyB0aWxlSWQ7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gZW1iZWRVcmw7XHJcblx0ICAgIH07XHJcblx0ICAgIFRpbGUuYXR0cmlidXRlID0gJ3Bvd2VyYmktdGlsZSc7XHJcblx0ICAgIHJldHVybiBUaWxlO1xyXG5cdH0oZW1iZWRfMS5kZWZhdWx0KSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFRpbGU7XHJcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBvd2VyYmkuanMubWFwIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
